"use strict";(self["webpackChunk_amp_ui_commerce_commerce_web_app"]=self["webpackChunk_amp_ui_commerce_commerce_web_app"]||[]).push([[87488],{25841:(e,t,n)=>{n.d(t,{DD:()=>D});class i{constructor(){this.registry=new Map}emit(e,...t){var n;const i=null!==(n=this.registry.get(e))&&void 0!==n?n:[];for(const s of i)s(...t)}on(e,t){{let n=this.registry.get(e);n||this.registry.set(e,n=new Set),n.add(t)}const n=()=>{const n=this.registry.get(e);return!(!n||!n.has(t))&&(1===n.size?this.registry.delete(e):n.delete(t))};return n}getListeners(e){const t=this.registry.get(e);return t?[...t]:[]}}const s=["keypress","keydown","click","mousemove","scroll","touchmove","touchstart"];let o=Date.now();const r=()=>{o=Date.now()};s.forEach((e=>{window.addEventListener(e,r,!1)}));const a=(e,{interval:t=1e4,threshold:n=6e4}={})=>{let i=!1;const s=setInterval((()=>{const t=Date.now()-o>=n;i!==t&&(i=t,e(i))}),t);return()=>clearInterval(s)},c=e=>(e+256).toString(16).substr(1),h=e=>crypto.getRandomValues(new Uint8Array(e)),d=[4,6,8,10],l=()=>{const e=h(16);e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t="";for(let n=0;n<e.length;n++)d.includes(n)&&(t+="-"),t+=c(e[n]);return t};function u(e,t){return e.width===t.width&&e.height===t.height}function g(e){let t;if(e.contentBoxSize)if(e.contentBoxSize[0])t={width:e.contentBoxSize[0].inlineSize,height:e.contentBoxSize[0].blockSize};else{const n=e.contentBoxSize;t={width:n.inlineSize,height:n.blockSize}}else t={width:e.contentRect.width,height:e.contentRect.height};return t}function w(e,t){let n;const i=new ResizeObserver((e=>{for(const i of e){const e=g(i);n&&u(n,e)||(n=e,t(e))}}));return i.observe(e),()=>i.disconnect()}let S=-1,p=0;function m(e){let t="";const n=Date.now();return S===n?p++:(p=0,S=n),t+=n+"-"+p,e&&(t=e+t),t}const E="winio:",R=(e,t)=>`${E}${e}${JSON.stringify(t)}`,O=(e,t)=>{const n=t.substring(E.length+e.length);return JSON.parse(n)},f=(e,t)=>"string"===typeof t&&t.startsWith(E)&&t.substr(E.length,e.length)===e,y=3,A=5e3,N=new Set(["SYN","SYN/ACK","ACK"]),_=new Set([...N,"connected"]);class C extends i{constructor(e,t,{source:n=window,timeout:i=A,namespace:s=""}={}){if(super(),this.target=e,this.targetOrigin=t,this.preConnectionEvents=[],"*"===t)throw new Error("targetOrigin can not be '*'");if(t.split("*").length>2)throw new Error("targetOrigin can only use 1 wildcard '*'");this.source=n,this.namespace=s,this.isConnected=!1,this.isListening=!1,this.timeout=i,this.logs=[]}handleMessageEvent(e){const t=this.targetOrigin.split("*"),n=t.length>1,i=n?e.origin.startsWith(t[0])&&e.origin.endsWith(t[1]):e.origin===this.targetOrigin;if(i&&e.source===this.target&&f(this.namespace,e.data)){const t=O(this.namespace,e.data),{winio:i,event:s}=t;N.has(s.name)||this.isConnected&&i.cid===this.connectionID?(n&&"SYN"===s.name&&(this.targetOrigin=e.origin),this.log({type:"on",data:t}),super.emit(s.name,s.payload)):this.preConnectionEvents.push(e)}}async startHandshake(){let e=0,t=0,n=Math.ceil(this.timeout/2**y);while(e<y)try{return e===y-1&&n<this.timeout-t&&(n=this.timeout-t),void await this.attemptHandshake(n)}catch{t+=n,e+=1,n*=2}throw new Error("Handshake failed")}attemptHandshake(e){return this.handshakePromise=new Promise(((t,n)=>{this.resolveHandshake=t,setTimeout((()=>{this.isConnected||n()}),e)})),this.internalEmit("SYN",{connectionID:m()}),this.handshakePromise}handshakeAcknowledged(e,t){var n;this.isConnected=!0,this.connectionID=e,null===(n=this.resolveHandshake)||void 0===n||n.call(this),super.emit("connected",t),this.preConnectionEvents.length>0&&(this.preConnectionEvents.forEach((e=>{this.handleMessageEvent(e)})),this.preConnectionEvents=[])}emit(e,t){if(_.has(e))throw new Error(`"${e}" is a reserve event.`);if(!this.isConnected)throw new Error("Connection has to be establish before emitting events.");this.internalEmit(e,t)}internalEmit(e,t){const n={winio:{cid:this.connectionID,eid:m()},event:{name:e,payload:t}};this.log({type:"emit",data:n}),this.target.postMessage(R(this.namespace,n),this.targetOrigin)}open(e){if(this.isListening)throw new Error("Can't use both 'open' and 'connect' in the same connection");this.on("SYN",(t=>{this.internalEmit("SYN/ACK",{connectionID:t.connectionID,data:e})})),this.on("SYN/ACK",(t=>{this.internalEmit("ACK",{connectionID:t.connectionID,data:e}),this.handshakeAcknowledged(t.connectionID,t.data)})),this.on("ACK",(e=>{this.handshakeAcknowledged(e.connectionID,e.data)})),this.source.addEventListener("message",(e=>this.handleMessageEvent(e)),!1),this.isListening=!0}connect(e={}){if(this.isListening)throw new Error("Can't use both 'open' and 'connect' in the same connection");if(this.targetOrigin.includes("*"))throw new Error("Can't use 'connect' with a targetOrigin that uses a wildcard, please use 'open' instead to wait for a connection.");return this.open(e.data),this.startHandshake()}getLogs(){return this.logs}log(e){this.logs.push(e)}}const v="cwadl_",I=()=>{const e=new URLSearchParams(window.location.search),t=new URLSearchParams;for(const[n,i]of e.entries())n.startsWith(v)&&t.append(n.slice(v.length,n.length),i);return{searchParams:t,search:t.toString()}},T=6e4;class D{constructor(e,t){this.version="0.5.6",this.isIdle=!1,this.internalEvents=new i,this._deepLink=I(),this.connection=new C(window.parent,e,{namespace:"amk:module"}),this.connecting=this.connection.connect({data:{version:this.version}}),this._configuration=this.connecting.then((()=>(this.emit("getConfiguration"),this.registerEvent("configuration").then((e=>(e.deepLink&&(e.deepLink.searchParams=new URLSearchParams(e.deepLink.search)),e)))))),this.connecting.then((()=>{if(null===t||void 0===t?void 0:t.autoResize){const{width:e,height:n}=t.autoResize.getBoundingClientRect();this.connection.emit("resize",{width:e,height:n}),w(t.autoResize,(e=>{this.connection.emit("resize",e)}))}setInterval((()=>{this.connection.emit("status",{idle:this.isIdle})}),T)})),a((e=>{this.isIdle=e})),this.connection.on("willBeShown",(async(e,t)=>{const n=this.internalEvents.getListeners("_willBeShown"),i=[];for(const s of n)i.push(s(e,t));await Promise.all(i),this.connection.emit("willBeShownResolved")}))}async emit(e,t){await this.connecting,this.connection.emit(e,t)}get configuration(){return this._configuration}show(){this.readyToBeShown()}readyToBeShown(){this.emit("readyToBeShown")}hide(e){this.close(e&&{data:e})}close(e={}){this.emit("close",e)}openModule(e,t={}){return new Promise(((n,i)=>{const s=l(),o=this.connection.on("moduleClosed",(({uuid:e,data:t})=>{e===s&&(a(),n(t))})),r=this.connection.on("openModuleFailed",(({uuid:e})=>{e===s&&(a(),i())}));function a(){o(),r()}this.emit("openModule",{name:e,uuid:s,options:t})}))}pushModule(e,t={}){return new Promise(((n,i)=>{const s=this.connection.on("pushModuleResolved",(({data:e})=>{r(),n(e)})),o=this.connection.on("pushModuleFailed",(()=>{r(),i()}));function r(){s(),o()}this.emit("pushModule",{name:e,options:t})}))}popModule(e={}){this.emit("popModule",{destroy:!0,...e})}renewAuthTokens(){return this.emit("renewAuthTokens"),this.registerEvent("authTokensRenewed")}registerEvent(e,t){return new Promise(((n,i)=>{const s=this.connection.on(e,(e=>{s(),t?t(e,n,i):n(e)}))}))}continueOnDevice(e,{onEvent:t,...n}={}){if(this.emit("continueOnDevice",[e,n]),t){const e=this.connection.on("continueOnDeviceSuccess",(()=>{e(),t("success")})),n=this.connection.on("continueOnDeviceError",(()=>{n(),t("error")})),i=this.connection.on("continueOnDeviceDismissed",(()=>{i(),t("dismissed")}))}return this.registerEvent("continueOnDeviceSettled")}challengeWith(e){return this.emit("challengeWith",e),this.registerEvent("challengeWithSettled",((e,t,n)=>{(null===e||void 0===e?void 0:e.challengeCancelled)?n(e):t()}))}onMessage(e,t){return this.connection.on("amkClientMessage",(n=>{n.messageName===e&&t({source:n.source,...n.data?{data:n.data}:{}})}))}emitMessage(e,t,n={}){this.emit("amkClientMessage",{target:t,messageName:e,data:n.data})}onWillBeShown(e){return this.internalEvents.on("_willBeShown",e)}onWasShown(e){return this.connection.on("wasShown",e)}navigateToSection(e){return this.emit("navigateToSection",{section:e})}get deepLink(){return this._deepLink}}var P,L;(function(e){e["Password"]="password"})(P||(P={})),function(e){e["FamilySharing"]="familySharing",e["ManageSubscriptions"]="manageSubscriptions",e["PaymentShipping"]="paymentShipping",e["Wallet"]="wallet",e["AccountRecovery"]="accountRecovery",e["LegacyContact"]="legacyContact",e["ManageCustodian"]="manageCustodian",e["PasswordAndSecurity"]="passwordAndSecurity",e["PersonalInformation"]="personalInfo",e["AddSecurityKeys"]="addSecurityKeys",e["ManageSecurityKeys"]="manageSecurityKeys",e["CoverageCentral"]="coverageCentral"}(L||(L={}))},45518:(e,t,n)=>{async function i(e){const t=new TextEncoder,n=t.encode(e),i=await crypto.subtle.digest("SHA-256",n),s=Array.from(new Uint8Array(i)),o=s.map((e=>e.toString(16).padStart(2,"0"))).join("");return o}function s(e){const t=e.match(/.{1,2}/g);if(null===t)throw new Error("not hex string");const n=new Uint8Array(t.map((e=>parseInt(e,16)))),i=btoa(String.fromCharCode(...n));return i}n.d(t,{W:()=>s,z:()=>i})},32218:(e,t,n)=>{n.d(t,{JS:()=>h,LP:()=>u,oT:()=>g,OA:()=>w});const i={servicePath:"/credential/token"};var s,o,r=n(45518);(function(e){e["PASSWORD_TOO_LONG"]="100",e["PASSWORD_EXCLUDED_CHARACTERS"]="101",e["PASSWORD_TOO_SHORT"]="102",e["PASSWORD_SAME_AS_ACCOUNT"]="103",e["PASSWORD_MISSING_NUMBER"]="104",e["PASSWORD_MISSING_LOWERCASE"]="105",e["PASSWORD_CONSECUTIVE_LETTERS"]="106",e["PASSWORD_MISSING_UPPERCASE"]="107",e["PASSWORD_DICTIONARY_WORDS"]="108",e["PASSWORD_CONTAINS_SPACES"]="109"})(s||(s={})),function(e){e["AUTHORIZATION_MISSING"]="110",e["APP_ID_MISSING"]="111",e["APP_ID_NOT_ALLOWED"]="112",e["INVALID_A3_TOKEN"]="113",e["A3_TOKEN_EXCEPTION"]="114",e["INVALID_PASSWORD_TOKEN"]="115",e["TOKEN_GENERATION_ERROR"]="116",e["APP_ID_MISMATCH"]="117",e["JWT_TOKEN_EXPIRED"]="118",e["UNSUPPORTED_CONTENT_TYPE"]="119",e["UNSUPPORTED_REQUEST_METHOD"]="120"}(o||(o={}));const a={...s,...o,INVALID_CREDENTIAL_FORMAT:"1001",UNKNOWN_ERROR:"9999"};var c,h;(function(e){e["EMAIL"]="email",e["PHONE"]="phone"})(c||(c={})),function(e){e["PASSWORD_VALIDATION_ERROR"]="PasswordValidationError",e["AUTH_ERROR"]="AuthError",e["CLIENT_ERROR"]="ClientError",e["UNKNOWN_ERROR"]="UnknownError"}(h||(h={}));class d extends Error{constructor(e,t,n=!1,i){super(t),this.errorCode=e,this.name="CredentialServiceError",this.isServerError=n,this.originalResponse=i,Object.setPrototypeOf(this,d.prototype),this.classification=d.classifyError(e)}static classifyError(e){const t=parseInt(e);return t>=100&&t<=109?{type:h.PASSWORD_VALIDATION_ERROR,shouldShowToUser:!0}:t>=110&&t<=120?{type:h.AUTH_ERROR,shouldShowToUser:!1}:t>=1e3?{type:h.CLIENT_ERROR,shouldShowToUser:!0}:{type:h.UNKNOWN_ERROR,shouldShowToUser:!1}}getUserMessage(){return this.classification.shouldShowToUser?this.message:"An error occurred. Please try again."}shouldDisplayToUser(){return this.classification.shouldShowToUser}isPasswordValidationError(){return this.classification.type===h.PASSWORD_VALIDATION_ERROR}isAuthenticationError(){return this.classification.type===h.AUTH_ERROR}isClientError(){return this.classification.type===h.CLIENT_ERROR}getClassificationType(){return this.classification.type}}function l(){const e=e=>Math.floor(Math.random()*Math.pow(10,e)).toString().padStart(e,"0"),t=e(6),n=e(4),i=e(6);return`credential-${t}-${n}-${i}`}async function u(e){try{if(!e.token||!e.serviceURL||!e.data)throw new d(a.INVALID_CREDENTIAL_FORMAT,"Missing required parameters");const n=e.requestId||l(),s=e.locale,{accountName:o,password:h,appId:u}=e.data;if(!o||!h||!u)throw new d(a.INVALID_CREDENTIAL_FORMAT,"Missing accountName, password, or appId");const g=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,w=g.test(o);let S,p,m="";if(w){S=c.EMAIL;const[e,t]=o.split("@");if(!e||!t)throw new d(a.INVALID_CREDENTIAL_FORMAT,"Invalid email format");p=await(0,r.z)(e.toLowerCase()),m=await(0,r.z)(t.toLowerCase())}else S=c.PHONE,p=await(0,r.z)(o.toLowerCase());const E={accNameHash:(0,r.W)(p),domainHash:S===c.EMAIL?(0,r.W)(m):"",password:h,isEmailFormat:w,requestId:n};s&&(E.locale=s);const R=await fetch(`${e.serviceURL}${i.servicePath}`,{method:"POST",mode:"cors",body:JSON.stringify(E),headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`,appId:u}});if(!R.ok){let e;try{e=await R.json()}catch(t){throw new d(a.UNKNOWN_ERROR,`HTTP ${R.status}: ${R.statusText}`,!0,R)}if(!e.errorCode||!e.errorMessage)throw new d(a.UNKNOWN_ERROR,"Invalid error response format",!0,R);throw new d(e.errorCode,e.errorMessage,!0,R)}const O=await R.json();if(!O.token)throw new d(a.UNKNOWN_ERROR,"Invalid token response format");return O}catch(n){if(n instanceof d)throw n;if(n instanceof TypeError&&n.message.includes("fetch"))throw new d(a.UNKNOWN_ERROR,"Network error: Unable to connect to credential service");throw new d(a.UNKNOWN_ERROR,n instanceof Error?n.message:"Unknown error occurred")}}function g(e){return e instanceof d?{errorCode:e.errorCode,message:e.getUserMessage(),shouldDisplay:e.shouldDisplayToUser(),classificationType:e.getClassificationType()}:{errorCode:a.UNKNOWN_ERROR,message:"An unexpected error occurred",shouldDisplay:!1,classificationType:h.UNKNOWN_ERROR}}function w(e){return e instanceof d}},63031:(e,t,n)=>{n.d(t,{hg:()=>c});const i=["keypress","keydown","click","mousemove","scroll","touchmove","touchstart"];let s=Date.now();const o=()=>{s=Date.now()};i.forEach((e=>{window.addEventListener(e,o,!1)}));const r=new Set(["SYN","SYN/ACK","ACK"]);new Set([...r,"connected"]);var a,c;(function(e){e["Password"]="password"})(a||(a={})),function(e){e["FamilySharing"]="familySharing",e["ManageSubscriptions"]="manageSubscriptions",e["PaymentShipping"]="paymentShipping",e["Wallet"]="wallet",e["AccountRecovery"]="accountRecovery",e["LegacyContact"]="legacyContact",e["ManageCustodian"]="manageCustodian",e["PasswordAndSecurity"]="passwordAndSecurity",e["PersonalInformation"]="personalInfo",e["AddSecurityKeys"]="addSecurityKeys",e["ManageSecurityKeys"]="manageSecurityKeys",e["CoverageCentral"]="coverageCentral"}(c||(c={}))}}]);
