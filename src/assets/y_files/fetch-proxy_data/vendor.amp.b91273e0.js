(self["webpackChunk_amp_ui_commerce_commerce_web_app"]=self["webpackChunk_amp_ui_commerce_commerce_web_app"]||[]).push([[87590],{87991:(t,e,r)=>{"use strict";r.d(e,{g:()=>i,r:()=>n});const n=57365==r.j?["tv-plus","arcade","bundle","icloud","music","news-plus","fitness-plus"]:null,i=57365==r.j?["us","ca","gb","fr","se","no","de","ie","au","dk","jp","it","ch","cz","cu","at","il","es","nl","ru","do","co","br","mx","ar","is","fi","ps","sz","zw","lc","sk","mg","az","gp","tg","sd","gt","nc","pm","bi","ml","sy","mw","bm","dz","pa","nu","li","mv","la","pw","vn","ly","aq","bo","gl","ph","mc","cl","ky","yu","bw","tt","pk","om","lv","mp","af","pn","tk","ug","mm","cx","ee","sh","gr","aw","be","mz","td","lu","dj","lk","kz","cd","iq","mt","tr","er","ni","ls","sn","gy","vu","za","pt","bh","kg","gq","ke","tj","cv","tp","lb","vi","hn","na","ro","hm","tz","fm","gf","wf","sl","pl","cf","tv","sj","vc","km","kn","cc","um","mk","ae","nz","kh","bb","bs","so","sr","pg","st","bf","mo","sv","ad","al","sb","tc","gw","id","dm","ye","nr","bg","ir","sa","ve","ao","sg","gd","ck","as","fk","cm","cg","kw","mq","pf","zm","to","lr","pe","ms","bz","gu","qa","am","ki","cy","hr","kp","cn","gm","mh","si","fo","rw","yt","mr","lt","np","gh","pr","ai","ua","fj","gs","ws","cr","ng","bd","py","hk","uz","tm","ag","io","my","tn","re","in","sm","tw","bt","gi","fx","an","ne","md","th","ba","hu","ga","nf","eh","ec","bn","mu","jm","ge","gn","sc","tf","et","eg","bj","kr","va","vg","ht","jo","uy","ci","mn","ma","bv","by","ww","eu","zz","zy","rs","ax","tl","gg","im","je","me","bl","mf","xk","ss","cw","bq","sx"]:null},613:(t,e,r)=>{"use strict";r.d(e,{k:()=>f});var n=r(52117),i=(r(80978),r(23395),r(87991));const o=t=>null!==t&&"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.baseUrl)&&"string"===typeof(null===t||void 0===t?void 0:t.language)&&"string"===typeof(null===t||void 0===t?void 0:t.storefront)&&"string"===typeof(null===t||void 0===t?void 0:t.token)&&"function"===typeof(null===t||void 0===t?void 0:t.fetch)&&"string"===typeof(null===t||void 0===t?void 0:t.serviceType)),s=t=>null!==t&&"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.baseUrl)&&"string"===typeof(null===t||void 0===t?void 0:t.language)&&"string"===typeof(null===t||void 0===t?void 0:t.storefront)&&"string"===typeof(null===t||void 0===t?void 0:t.token)&&"function"===typeof(null===t||void 0===t?void 0:t.fetch)&&"string"===typeof(null===t||void 0===t?void 0:t.linkCode)),a=t=>null!==t&&"object"===typeof t&&("string"===typeof(null===t||void 0===t?void 0:t.baseUrl)&&"string"===typeof(null===t||void 0===t?void 0:t.language)&&"string"===typeof(null===t||void 0===t?void 0:t.storefront)&&"string"===typeof(null===t||void 0===t?void 0:t.token)&&"function"===typeof(null===t||void 0===t?void 0:t.fetch)&&("string"===typeof(null===t||void 0===t?void 0:t.linkCode)||"string"===typeof(null===t||void 0===t?void 0:t.serviceType))),u=t=>i.r.includes(t),c=t=>i.g.includes(t);class l extends Error{constructor(t,e){super(`${t} is not a supported ${e}`),this.value=t,this.type=e}}r(70309),r(31629),r(84163);class d extends Error{constructor({status:t},e){super(`HTTP Error ${t}: ${e.errors[0].title}: ${e.errors[0].detail}`),this.status=t,this.payload=e,this.meta=e.meta,this.errors=e.errors}}const h=async(t,e,r,i)=>{const a=new URL(t,e.baseUrl),u={Authorization:`Bearer ${e.token}`,"Content-type":"application/json"},c=(0,n.Z)((0,n.Z)((0,n.Z)({},o(e)&&{serviceType:e.serviceType}),s(e)&&{linkCode:e.linkCode}),{},{l:e.language,platform:"web"}),l=(0,n.Z)((0,n.Z)({},c),r),h=(0,n.Z)((0,n.Z)({},i),{},{headers:u});for(const[n,o]of Object.entries(l))a.searchParams.append(n,o);const f=await e.fetch(a,h),p=await f.json();if(f.ok)return p;throw new d(f,p)};class f{constructor(t){if(this.config=t,!a(this.config))throw new Error("Missing required configuration params.");if(o(this.config)&&!u(this.config.serviceType))throw new l(this.config.serviceType,"serviceType");if(!c(this.config.storefront))throw new l(this.config.storefront,"storefront")}async getMarketingItemsPlacement(t,e){const r=`/v1/engagement/${this.config.storefront}/upsell/marketing-items`;if(o(this.config)&&!t)throw new Error("Missing required params: either a placement or linkCode must be provided.");const i=(0,n.Z)((0,n.Z)({},t&&{placement:t}),{},{"extend[marketing-items]":"priceDiffsForDisplay",include:"contents","meta[marketing-items]":"metrics",offerHints:"aobUpsell"},e),s={method:"GET"};return h(r,this.config,i,s)}}},71139:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TreatmentProvider=void 0;const i=r(13715),o=r(65061);class s{constructor(t){this.treamentFinder=new o.TreatmentFinder(t.configFetcher)}findActiveTreatment(t){return n(this,void 0,void 0,(function*(){return this.treamentFinder.getTreatmentForArea(t.areaId,t.identifier,t.when,t.storefrontId)}))}generateAb2Data({identifiers:t,storefrontId:e,when:r}){return n(this,void 0,void 0,(function*(){const n=[];for(const{identifier:o,areaId:s}of t)n.push(this.ab2DataForArea({areaId:s,identifier:o,storefrontId:e,when:r}));const i=yield Promise.all(n);return i.filter((t=>t))}))}ab2DataForArea(t){return n(this,void 0,void 0,(function*(){const e=yield this.findActiveTreatment(t);if(e)return{areaId:t.areaId,treatmentId:e.id,bucket:e.optedIn?i.BucketNumberValue.OPTED_IN:i.BucketNumberValue.BUCKET_CALCULATION}}))}}e.TreatmentProvider=s},7153:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BucketAssignment=void 0;const i=r(7551),o=1e4;class s{constructor(t){this.seed=t}call(){return n(this,void 0,void 0,(function*(){const t=yield this.seed.getDigest(),e=new i.JavaRandom(t);return e.nextInt(o)}))}}e.BucketAssignment=s},1638:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigLoader=void 0;const i=r(51451),o=r(35965);class s{static call(t){return n(this,void 0,void 0,(function*(){const e=yield t(i.CONFIG.url);return o.ConfigParser.toAreas(e)}))}}e.ConfigLoader=s},35965:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConfigParser=e.Treatment=void 0;class r{constructor({id:t,buckets:e,config:r,optedIn:n}){this.id=t,this.buckets=e,this.config=r||{},this.optedIn=n}}e.Treatment=r;class n{static toAreas(t){return"string"===typeof t&&(t=JSON.parse(t)),t}}e.ConfigParser=n},51451:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONFIG=void 0,e.CONFIG={url:"https://experiments.apple.com/web/treatment_provider/config.json"}},79314:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Digest=void 0;const i=r(40907);class o{hexDigest(t){return n(this,void 0,void 0,(function*(){return i.sha256HexDigest(t)}))}binaryDigest(t){return n(this,void 0,void 0,(function*(){const e=yield i.sha256Digest(t);return new Uint8Array(e)}))}}e.Digest=o},88391:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(13715),e),i(r(72197),e),i(r(7153),e),i(r(35965),e),i(r(1638),e),i(r(75609),e),i(r(65061),e),i(r(71139),e)},7551:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.JavaRandom=void 0;const i=n(r(65432)),o=i.default.subtract(i.default.leftShift(i.default.BigInt(1),i.default.BigInt(48)),i.default.BigInt(1)),s=i.default.BigInt(25214903917),a=i.default.BigInt(11);class u{constructor(t){this.seed=i.default.bitwiseAnd(i.default.bitwiseXor(i.default.BigInt(t),s),o)}nextInt(t){const e=i.default.BigInt(t);let r=this.next(31);const n=i.default.subtract(e,i.default.BigInt(1));if(i.default.equal(i.default.bitwiseAnd(e,n),i.default.BigInt(0)))r=i.default.signedRightShift(i.default.multiply(e,r),i.default.BigInt(31));else{let t=r;while(i.default.lessThan(i.default.add(i.default.subtract(t,r=i.default.remainder(t,e)),n),i.default.BigInt(0)))t=this.next(31)}return r}next(t){const e=this.seed,r=i.default.bitwiseAnd(i.default.add(i.default.multiply(e,s),a),o);return this.seed=r,i.default.signedRightShift(r,i.default.subtract(i.default.BigInt(48),i.default.BigInt(t)))}}e.JavaRandom=u},75609:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Seed=void 0;const o=r(79314),s=i(r(65432)),a=r(40907);class u{constructor(t,e){this.identifier=e,this.digest=new o.Digest,this.areaId=t.id,this.areaSalt=t.salt}getOptInKey(){return n(this,void 0,void 0,(function*(){const t=Math.floor(a.endOfWeek().getTime()/1e3),e=this.identifier+this.areaId+t;return this.digest.hexDigest(e)}))}getDigest(){return n(this,void 0,void 0,(function*(){const t=this.identifier+(this.areaSalt||"")+this.areaId,e=yield this.digest.binaryDigest(t),r=new Uint8Array(8),n=e.length-r.length,i=n>0?n:0;for(let s=0;s<8;s++)r[s]=e[s+i];let o=s.default.BigInt(0);for(let a=0;a<r.length;a++){const t=s.default.leftShift(o,s.default.BigInt(8));o=s.default.add(t,s.default.BigInt(255&r[a]))}return o}))}}e.Seed=u},65061:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.TreatmentFinder=void 0;const o=i(r(65432)),s=r(35965),a=r(7153),u=r(75609),c=r(1638);class l{constructor(t){this.areasPromise=null,this.httpLoader=t}getTreatmentForArea(t,e,r=new Date,i){return n(this,void 0,void 0,(function*(){let n;const o=yield this.findArea(t);if(!o)return;const s=new u.Seed(o,e),[a,c,l]=yield Promise.all([this.findExperiments(o,r,i),this.findBucket(s),this.calculateOptInKey(s)]);return o.optIns&&o.optIns[l]&&(n=o.optIns[l]),a?this.findTreatment(a,c,n):void 0}))}getExperimentsForArea(t,e=new Date){return n(this,void 0,void 0,(function*(){const r=yield this.findArea(t);if(!r)return[];const n=yield this.findExperiments(r,e);return n||[]}))}getAreas(){return n(this,void 0,void 0,(function*(){const t=yield c.ConfigLoader.call(this.httpLoader);return s.ConfigParser.toAreas(t)}))}getAreaPromise(){return n(this,void 0,void 0,(function*(){return null!=this.areasPromise||(this.areasPromise=this.getAreas()),this.areasPromise}))}findArea(t){return n(this,void 0,void 0,(function*(){try{const e=yield this.getAreaPromise(),r=e.find((e=>e.id===t));return r||void 0}catch(e){throw`Failed to retrieve AB Configuration: ${e.toString()}`}}))}findExperiments(t,e,r){return n(this,void 0,void 0,(function*(){let n=t.experiments.filter((t=>t.startTime<e.getTime()&&t.endTime>e.getTime()));return n=n.filter((t=>0==t.storefrontIds.length||r&&t.storefrontIds.includes(r))),n.length>0?n:void 0}))}findBucket(t){return n(this,void 0,void 0,(function*(){return new a.BucketAssignment(t).call()}))}calculateOptInKey(t){return t.getOptInKey()}findTreatment(t,e,r){return n(this,void 0,void 0,(function*(){const n=([t,r])=>o.default.lessThanOrEqual(o.default.BigInt(t),e)&&o.default.greaterThanOrEqual(o.default.BigInt(r),e);let i,a;for(const e of t){for(const t of e.treatments){if(r&&t.id===r){i=t;break}if(t.buckets.find(n)&&(a=t,!r))break}if(i||a&&!r)break}const u=i||a;if(!u)return;const c=new s.Treatment(Object.assign(Object.assign({},u),{optedIn:!!i}));return c}))}}e.TreatmentFinder=l},49329:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BucketNumberValue=void 0,function(t){t["OPTED_IN"]="-1",t["BUCKET_CALCULATION"]="-2"}(e.BucketNumberValue||(e.BucketNumberValue={}))},744:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},60976:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},89010:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},72197:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(744),e),i(r(89010),e),i(r(60976),e)},13715:function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(49329),e)},10737:(t,e)=>{"use strict";function r(t=new Date){const e=(7-t.getUTCDay())%7,r=new Date(t);return r.setUTCDate(r.getUTCDate()+e),r.setUTCHours(23,59,59,0),r}Object.defineProperty(e,"__esModule",{value:!0}),e.endOfWeek=void 0,e.endOfWeek=r},40907:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha256HexDigest=e.sha256Digest=e.endOfWeek=void 0;var n=r(10737);Object.defineProperty(e,"endOfWeek",{enumerable:!0,get:function(){return n.endOfWeek}});var i=r(70994);Object.defineProperty(e,"sha256Digest",{enumerable:!0,get:function(){return i.sha256Digest}}),Object.defineProperty(e,"sha256HexDigest",{enumerable:!0,get:function(){return i.sha256HexDigest}})},76602:function(t,e){"use strict";var r=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.sha256HexDigest=e.sha256Digest=void 0;const n=()=>r(void 0,void 0,void 0,(function*(){return new ArrayBuffer(0)})),i=t=>r(void 0,void 0,void 0,(function*(){const e=yield o(t),r=Array.from(new Uint8Array(e)).map((t=>t.toString(16).padStart(2,"0"))).join("");return r}));e.sha256HexDigest=i;const o=t=>r(void 0,void 0,void 0,(function*(){if(!window.crypto)return n(t);{const r=(new TextEncoder).encode(t);try{return window.crypto.subtle.digest({name:"SHA-256"},r)}catch(e){return window.crypto.subtle.digest("SHA-256",r)}}}));e.sha256Digest=o},70994:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sha256HexDigest=e.sha256Digest=void 0;var n=r(76602);Object.defineProperty(e,"sha256Digest",{enumerable:!0,get:function(){return n.sha256Digest}}),Object.defineProperty(e,"sha256HexDigest",{enumerable:!0,get:function(){return n.sha256HexDigest}})},1247:t=>{var e=["affC","adId","advp","at","ct","itsct","itscg","itscc","itcCt","its_qt","ls","partnerId","pt","qtkid","uo"],r=["mttn3pid","mttnagencyid","mttncc","mttnmyad","mttnmyadg","mttnmycmp","mttnmykw","mttnmypla","mttnmypub","mttnmysite","mttnpid","mttnrefid","mttnsiteid","mttnsub1","mttnsub2","mttnsub3","mttnsubad","mttnsubadgp","mttnsubcmp","mttnsubkw","mttnsubpid","mttnsubplmnt","mttnsubsite","gclid"],n="https://itunes.apple.com/WebObjects/MZStoreServices.woa/wa/processRedirectUrl",i="https://xp.apple.com/register";t.exports={knownCampaignQueryParams:e,knownMarketingQueryParams:r,processRedirectUrlEndpoint:n,metricsRegisterEndpoint:i}},23497:(t,e,r)=>{var n=r(1247),i=r(62653),o=i.cookieStringFromResponse,s=i.addHeadersToRequest,a=i.promisifyXHR;function u(){var t=new XMLHttpRequest;return t.open("GET",n.metricsRegisterEndpoint),t.withCredentials=!0,a(t)}function c(t,e,r){var n;n=r.customXhr?r.customXhr:"undefined"!==typeof itms?itms.makeStoreXMLHttpRequest():new XMLHttpRequest,n.open("POST",e),n.withCredentials=!0,s(n,{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}),s(n,r.headers);var i="url="+encodeURIComponent(t);return a(n,i).then((function(t){var e=t.response,r=t.status;if(200===r&&""!==e){var n=JSON.parse(e);return n.setCookies.forEach((t=>{document.cookie=o(t)})),n.redirectUrl}}))}t.exports=function(t,e){var r=e||{};if(!i.hasQueryParams(t,n.knownCampaignQueryParams))return Promise.reject("No campaign or affiliate query params found");var o=r.endpoint||n.processRedirectUrlEndpoint;return u().then((function(){return c(t,o,r)}))}},54164:(t,e,r)=>{var n=r(1247),i=r(23497);t.exports={handleCampaignAndAffiliateUrls:i,knownCampaignQueryParams:n.knownCampaignQueryParams,knownMarketingQueryParams:n.knownMarketingQueryParams,PROCESS_REDIRECT_URL_ENDPOINT:n.processRedirectUrlEndpoint,METRICS_REGISTER_ENDPOINT:n.metricsRegisterEndpoint}},30535:t=>{t.exports=function(t,e){if(e&&"object"===typeof e)for(var r in e)e[r]&&t.setRequestHeader(r,e[r])}},7959:t=>{function e(t){return Object.keys(t).reduce(((e,r)=>["name","value"].includes(r)?e:`${e};${r}=${t[r]}`),`${t.name}=${t.value}`)}t.exports=e},52532:t=>{function e(t,e){var r=t.indexOf("?")>-1?t.split("?")[1]:t,n=r.split("&"),i=e;if(i||(i=[]),t&&""!==t.trim())for(var o=0;o<n.length;o++){var s=n[o].split("="),a=s[0],u=s[1];if(i.indexOf(a)>-1)return"at"!==a||!!u.match(/^[a-zA-Z0-9]+$/)}return!1}t.exports=e},62653:(t,e,r)=>{t.exports={hasQueryParams:r(52532),addHeadersToRequest:r(30535),promisifyXHR:r(17121),cookieStringFromResponse:r(7959)}},17121:t=>{t.exports=function(t,e){return new Promise((function(r,n){t.onload=function(){t.status<200||t.status>=300?n({request:t}):r(t)},t.onerror=function(){n({request:t})},e?t.send(e):t.send()}))}},11872:(t,e,r)=>{"use strict";r.r(e),r.d(e,{API:()=>ie,Library:()=>Xt,LocalDataStore:()=>Ut,MKError:()=>X,Podcasts:()=>ee,RatingContentTypes:()=>Jt,formatArtworkURL:()=>$,formatRatingsContentType:()=>et,hasMovementsOrWorks:()=>tt,isPaginatedRequestResult:()=>rt,makeRequest:()=>nt,mergeResponseAttributes:()=>ot,transformDescriptorsToIdMap:()=>Nt,transformParameters:()=>It,transformStoreData:()=>kt,transformTrackParameters:()=>Dt});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},n(t,e)};function i(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var o=function(){return o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function s(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&(r[n[i]]=t[n[i]])}return r}function a(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new r((function(e){e(t.value)})).then(s,a)}u((n=n.apply(t,e||[])).next())}))}function u(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(s)try{if(r=1,n&&(i=2&o[0]?n["return"]:o[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function c(t){var e="function"===typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function l(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}var h="undefined"!==typeof FastBoot?FastBoot.require("buffer").Buffer:"undefined"!==typeof process&&null!==process.versions&&null!==process.versions.node?Buffer:window.Buffer,f=y((function(t){return/^[a|i|l|p]{1}\.[a-zA-Z0-9]+$/.test(t)}));function p(t){var e=function(t){return"undefined"!==typeof t&&null!==t};return 0===arguments.length&&"undefined"!==typeof process&&(t=process),e(t)&&e(t.versions)&&e(t.versions.node)||"undefined"!==typeof FastBoot}var v=y(p()?function(t){return h.from(t,"base64").toString("ascii")}:function(t){return window.atob(t)});y(p()?function(t){return h.from(t).toString("base64")}:function(t){return window.btoa(t)});function y(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n="",i=e.length;while(i--){var o=e[i];n+=o===Object(o)?JSON.stringify(o):o,t._memoized||(t._memoized={})}return n in t._memoized?t._memoized[n]:t._memoized[n]=t.apply(void 0,e)}}function m(t){return t?Object.keys(t).reduce((function(e,r){var n=t[r];return n.constructor===Object?Object.keys(n).reduce((function(t,e){return t+(t?"&":"")+encodeURIComponent(r)+"["+encodeURIComponent(e)+"]="+encodeURIComponent(n[e])}),e):e+(e?"&":"")+encodeURIComponent(r)+"="+encodeURIComponent(t[r])}),""):""}function g(t){try{var e=l(t.split("?",2),2),r=e[0],n=e[1];if("undefined"===typeof n)return r;var i=n.split("&").map((function(t){return t.split("=",2)})),o=d(Array(i.length).keys());o.sort((function(t,e){var r=i[t],n=i[e];return r<n?-1:r>n?1:t-e}));var s=o.map((function(t){return i[t]})),a=s.map((function(t){var e=l(t,2),r=e[0],n=e[1];return"undefined"!==typeof n?r+"="+n:r})).join("&");return r+"?"+a}catch(u){return t}}var b="ACCESS_DENIED",_="AGE_VERIFICATION",w="AUTHORIZATION_ERROR",E="CONFIGURATION_ERROR",T="CONTENT_EQUIVALENT",S="CONTENT_RESTRICTED",R="CONTENT_UNAVAILABLE",O="CONTENT_UNSUPPORTED",A="DEVICE_LIMIT",P="INVALID_ARGUMENTS",I="MEDIA_CERTIFICATE",k="MEDIA_DESCRIPTOR",C="MEDIA_LICENSE",D="MEDIA_KEY",N="MEDIA_PLAYBACK",j="MEDIA_SESSION",M="NETWORK_ERROR",U="NOT_FOUND",L="PARSE_ERROR",B="PLAY_ACTIVITY",x="REQUEST_ERROR",z="QUOTA_EXCEEDED",G="SERVER_ERROR",V="SERVICE_UNAVAILABLE",F="STREAM_UPSELL",H="SUBSCRIPTION_ERROR",K="TOKEN_EXPIRED",q="UNAUTHORIZED_ERROR",W="UNKNOWN_ERROR",Z="UNSUPPORTED_ERROR",J={400:x,401:q,403:b,404:U,405:U,413:x,414:x,429:z,500:G,501:U,503:V},Y={"-1004":A,1010:J[404],2002:w,2034:K,3059:A,3063:H,3076:R,3082:S,3084:F,5002:J[500]},Q=[],X=function(t){function e(r,n){var i=t.call(this)||this;return i.errorCode=W,r===Z||r===O?(i.name=i.errorCode=r,i.message=i.description=n||r):n||"string"!==typeof r?(i.name=i.errorCode=r||W,n&&(i.message=i.description=n)):(i.name=i.errorCode=W,i.message=i.description=r),Q.push(i),Error.captureStackTrace&&Error.captureStackTrace(i,e),i}return i(e,t),Object.defineProperty(e,"errors",{get:function(){return Q},enumerable:!0,configurable:!0}),e.playActivityError=function(t){return new this(B,t)},e.parseError=function(t){return new this(L,t)},e.responseError=function(t){var e=t.status,r=t.statusText,n=J[e]||M;return new this(n,r||""+e)},e.serverError=function(t){var e=t.status,r=t.dialog,n=t.failureType,i=t.customerMessage,o=t.errorMessage,s=t.message;r&&(s=r.message||r.customerMessage||r.errorMessage,r.message=s);var a=Y[n]||Y[e]||W,u=new this(a,s||i||o);return a===F&&r&&r.okButtonAction&&r.okButtonAction.url&&(r.okButtonAction.url=r.okButtonAction.url.replace(/\&(?:challenge|key-system|uri|user-initiated)=[^\&]+/gim,"")),u.dialog=r,u},e.ACCESS_DENIED=J[403],e.AGE_VERIFICATION=_,e.AUTHORIZATION_ERROR=Y["2002"],e.CONFIGURATION_ERROR=E,e.CONTENT_EQUIVALENT=T,e.CONTENT_RESTRICTED=Y["3082"],e.CONTENT_UNAVAILABLE=Y["3076"],e.CONTENT_UNSUPPORTED=O,e.DEVICE_LIMIT=Y["3059"],e.INVALID_ARGUMENTS=P,e.MEDIA_CERTIFICATE=I,e.MEDIA_DESCRIPTOR=k,e.MEDIA_LICENSE=C,e.MEDIA_KEY=D,e.MEDIA_PLAYBACK=N,e.MEDIA_SESSION=j,e.NETWORK_ERROR=M,e.NOT_FOUND=Y["1010"],e.PARSE_ERROR=L,e.PLAY_ACTIVITY=B,e.QUOTA_EXCEEDED=J[429],e.REQUEST_ERROR=J[400],e.SERVER_ERROR=Y["5002"],e.SERVICE_UNAVAILABLE=J[503],e.STREAM_UPSELL=Y["3084"],e.SUBSCRIPTION_ERROR=Y["3063"],e.TOKEN_EXPIRED=Y["2034"],e.UNAUTHORIZED_ERROR=J[401],e.UNKNOWN_ERROR=W,e.UNSUPPORTED_ERROR=Z,e}(Error);function $(t,e,r){return e=e||t.height||100,r=r||t.width||100,window.devicePixelRatio>=1.5&&(r*=2,e*=2),t.url.replace("{h}",""+e).replace("{w}",""+r).replace("{f}","jpeg")}function tt(t){return void 0===t&&(t=[]),0!==t.length&&t.filter((function(t){var e=t.attributes;return!!e&&(e.workName||e.movementName||e.movementCount||e.movementNumber)})).length>0}function et(t,e){return f(e)&&!/^library-/.test(t)?"library-"+t:t}function rt(t){return t&&"undefined"!==typeof t.data}function nt(t,e,r,n,i,o,s){return void 0===n&&(n={}),void 0===i&&(i=!0),void 0===o&&(o=!1),void 0===s&&(s=!1),a(this,void 0,void 0,(function(){var c,l,d,h,f,p,v,y,m,g,b,_=this;return u(this,(function(w){switch(w.label){case 0:l=e,d=r&&r.ids,h="undefined"!==typeof n.includePagination?n.includePagination:t.defaultIncludePaginationMetadata,delete n.includePagination,"string"===typeof d&&(l=e+"/"+d,r&&delete r.ids),w.label=1;case 1:return w.trys.push([1,3,,4]),n.useRawResponse=n.useRawResponse||h,[4,t.request(l,r,n)];case 2:return c=w.sent(),[3,4];case 3:return f=w.sent(),404===f.status?[2,Promise.reject(new X(X.CONTENT_UNAVAILABLE,"The requested content is not available."))]:[2,Promise.reject(X.responseError(f))];case 4:return w.trys.push([4,7,,8]),p=c.results||c.data||c,"object"===typeof c&&"results"in c&&"meta"in c&&(p.meta=c.meta),0===p.length?[2,Promise.reject(new X(X.CONTENT_UNAVAILABLE,"The requested content is not available."))]:s&&t.userToken&&d?(d=Array.isArray(d)?d:[d],d=Array.from(new Set(d)),[4,Promise.all(d.map((function(r,n){return a(_,void 0,void 0,(function(){var i;return u(this,(function(o){switch(o.label){case 0:return[4,t.request(e+"/"+r,{fields:"inLibrary"})];case 1:return i=o.sent(),ot([p[n]],i),[2]}}))}))})))]):[3,6];case 5:w.sent(),w.label=6;case 6:return v=o?p:t.parseResultData(i,p),h?(y=void 0,m=void 0,n.includePagination=!0,g=Object.assign({},n),delete g.offset,c.next&&(y=function(){return nt(t,it(t.url,c.next),r,g)}),c.previous&&(m=function(){return nt(t,it(t.url,c.previous),r,g)}),[2,{data:v,next:y,previous:m,meta:c.meta}]):[2,v];case 7:return b=w.sent(),[2,Promise.reject(X.parseError(b))];case 8:return[2]}}))}))}function it(t,e){var r=new window.window.URL(t).pathname,n=new RegExp("^"+r+"/");return e.replace(n,"")}function ot(t,e){t.map((function(t,r){var n=e[r];if(n&&n.attributes&&Object.keys(n.attributes).forEach((function(e){t.attributes[e]=n.attributes[e]})),t&&t.relationships&&t.relationships.tracks&&n&&n.relationships&&n.relationships.tracks){var i=n.relationships.tracks.data;t.relationships.tracks.data.forEach((function(t,e){var r=i[e];Object.keys(r.attributes).forEach((function(e){t.attributes[e]=r.attributes[e]}))}))}}))}function st(t){return void 0===t&&(t=[]),Array.isArray(t)?t:[t]}function at(t,e){return e.split(".").reduce((function(t,e){if(void 0!==t)return t[e]}),t)}function ut(t,e,r){return e.split(".").reduce((function(e,n,i,o){var s=i===o.length-1,a=e.hasOwnProperty(n),u=e[n]instanceof Object,c=null===e[n];if(!s&&a&&(!u||c))throw new TypeError("Value at "+o.slice(0,i+1).join(".")+" in keypath is not an Object.");return s?(e[n]=r,t):a?e[n]:e[n]={}}),t)}function ct(t,e){return Object.keys(t).reduce((function(r,n){var i,o=t[n];return i="function"===typeof o?o():at(e,o),i&&ut(r,n,i),r}),{})}function lt(t,e){return Object.keys(t).reduce((function(r,n){return r[e(n)]=t[n],r}),{})}var dt=function(){function t(t,e){var r=this;void 0===t&&(t=[]),this._eventRegistry={},t.forEach((function(t){r._eventRegistry[t]=[]})),e&&e.namespace&&(this.dispatchNamespace="com.apple."+e.namespace),this.shouldStorageDispatch&&window.addEventListener("storage",this._handleGlobalStorageEvent)}return Object.defineProperty(t.prototype,"shouldStorageDispatch",{get:function(){return"undefined"!==typeof window&&"undefined"!==typeof sessionStorage&&this.dispatchNamespace},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t,e){Array.isArray(this._eventRegistry[t])&&this._eventRegistry[t].push(e)},t.prototype.dispatchEvent=function(t,e){Array.isArray(this._eventRegistry[t])&&this._eventRegistry[t].forEach((function(t){return t(e)}))},t.prototype.dispatchDistributedEvent=function(t,e){if(this.dispatchEvent(t,e),this.shouldStorageDispatch){var r=this.dispatchNamespace+":"+t;sessionStorage.setItem(r,JSON.stringify(e))}},t.prototype.removeEventListener=function(t,e){if(Array.isArray(this._eventRegistry[t])){var r=this._eventRegistry[t].indexOf(e);this._eventRegistry[t].splice(r,1)}},t.prototype._handleGlobalStorageEvent=function(t){var e;if(this.dispatchNamespace&&(null===(e=t.key)||void 0===e?void 0:e.startsWith(this.dispatchNamespace+":"))){var r=t.key.substring(this.dispatchNamespace.length+1);this.dispatchEvent(r,JSON.parse(t.newValue))}},t}(),ht=function(t){return ft(t)&&!pt(t)};function ft(t){return!!t&&"object"===typeof t}function pt(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||gt(t)}var vt,yt="function"===typeof Symbol&&Symbol.for,mt=yt?Symbol.for("react.element"):60103;function gt(t){return t.$$typeof===mt}function bt(t){return Array.isArray(t)?[]:{}}function _t(t,e){return!1!==e.clone&&e.isMergeableObject(t)?Ot(bt(t),t,e):t}function wt(t,e,r){return t.concat(e).map((function(t){return _t(t,r)}))}function Et(t,e){if(!e.customMerge)return Ot;var r=e.customMerge(t);return"function"===typeof r?r:Ot}function Tt(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}function St(t){return Object.keys(t).concat(Tt(t))}function Rt(t,e,r){var n={};return r.isMergeableObject(t)&&St(t).forEach((function(e){n[e]=_t(t[e],r)})),St(e).forEach((function(i){r.isMergeableObject(e[i])&&t[i]?n[i]=Et(i,r)(t[i],e[i],r):n[i]=_t(e[i],r)})),n}function Ot(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||wt,r.isMergeableObject=r.isMergeableObject||ht;var n=Array.isArray(e),i=Array.isArray(t),o=n===i;return o?n?r.arrayMerge(t,e,r):Rt(t,e,r):_t(e,r)}Ot.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce((function(t,r){return Ot(t,r,e)}),{})},function(t){t["dataRecordDidDelete"]="dataRecordDidDelete",t["dataRecordWillDelete"]="dataRecordWillDelete",t["dataRecordDidMaterialize"]="dataRecordDidMaterialize",t["dataRecordDidPopulate"]="dataRecordDidPopulate",t["dataRecordWillPopulate"]="dataRecordWillPopulate"}(vt||(vt={}));var At=function(){function t(t,e,r){void 0===r&&(r={}),this.type=t,this.id=e,this._mjs={attributes:[],relationships:[],views:[]},this._meta={},this._mjs=o(o({},this._mjs),r)}return t.prototype.hasProperties=function(t){return!t||(t.attributes||t.relationships||t.views?!(t.attributes&&!this.hasAttributes(t.attributes))&&(!(t.relationships&&!this.hasRelationships(t.relationships))&&!(t.views&&!this.hasViews(t.views))):this.hasAttributes()||this.hasRelationships()||this.hasViews())},t.prototype.hasAttributes=function(t){return this._hasProperties(this._mjs.attributes,t)},t.prototype.hasRelationships=function(t){return this._hasProperties(this._mjs.relationships,t)},t.prototype.hasViews=function(t){return this._hasProperties(this._mjs.views,t)},t.prototype.meta=function(t){return t?this._meta[t]:this._meta},t.prototype.serialize=function(t,e){var r=this;void 0===t&&(t=!0),void 0===e&&(e={});var n={id:this.id,type:this.type};return e[this.type+"-"+this.id]?n:(e[this.type+"-"+this.id]=!0,this.hasAttributes()&&(n.attributes=this._mjs.attributes.reduce((function(t,e){return t[e]=r[e],t}),{})),this._mjs.relationships.length>0&&(n.relationships=this._serializeRelatedData(this._mjs.relationships,e)),this._mjs.views.length>0&&(n.views=this._serializeRelatedData(this._mjs.views,e)),t?{data:n}:n)},t.prototype.setProperty=function(e,r,n){function i(t,e,r){return e}function o(e){return!!e&&"object"===typeof e&&!(e instanceof t)}void 0===n&&(n="attributes"),this.hasOwnProperty(e)||(this._mjs[n]||(this._mjs[n]=[]),this._mjs[n].push(e));var s=function(t){return{value:t,writable:!0,configurable:!0,enumerable:!0}};this[e]&&r&&"object"===typeof this[e]&&"object"===typeof r?"attributes"===n?Object.defineProperty(this,e,s(Ot(this[e],r,{arrayMerge:i,isMergeableObject:o}))):"relationships"===n&&Array.isArray(this[e])&&this._mjs&&this._mjs.extendRelationships?Object.defineProperty(this,e,s(Ot(this[e],r,{isMergeableObject:o}))):Object.defineProperty(this,e,s(r)):Object.defineProperty(this,e,s(r))},t.prototype.removeRelative=function(t,e){this[t]&&(Array.isArray(this[t])?this[t]=this[t].filter((function(t){return t.id!==e})):delete this[t])},t.prototype.setParent=function(t){var e=this._mjs.parents,r=e&&e.length>0;this._mjs.parents=r?e.concat(t):t},t.prototype._hasProperties=function(t,e){return!!t&&(e?st(e).every((function(e){return t.includes(e)})):t.length>0)},t.prototype._serializeRelatedData=function(t,e){var r=this;return void 0===e&&(e={}),t.reduce((function(t,n){var i=r[n];return Array.isArray(i)?t[n]={data:i.map((function(t){return"function"===typeof t.serialize?t.serialize(!1,e):t}))}:t[n]=i&&"function"===typeof i.serialize?i.serialize(!1,e):i,t}),{})},t}(),Pt=function(t){function e(e){void 0===e&&(e={});var r=t.call(this,[vt.dataRecordDidDelete,vt.dataRecordWillDelete,vt.dataRecordDidMaterialize,vt.dataRecordWillPopulate,vt.dataRecordDidPopulate])||this;return r._extendRelationships=!1,r._removeOnExpiration=!1,r._records={},r._expiryRecords=new Set,r._extendRelationships=!!e.extendRelationships,r._removeOnExpiration=!!e.removeOnExpiration,r._mapping=e.mapping,r.filter=e.filter,r}return i(e,t),Object.defineProperty(e.prototype,"mapping",{get:function(){return this._mapping},set:function(t){this._mapping=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._records={},this._expiryRecords=new Set},e.prototype.peek=function(t,e,r){var n=this;if(this._checkForExpiredRecords(),!this._records[t])return e?null:[];if(!e)return Object.values(this._records[t]);if(Array.isArray(e))return e.map((function(e){var i=n._records[t][e];if(i&&i.hasProperties(r))return i}));var i=this._records[t][e];return i&&i.hasProperties(r)?i:null},e.prototype.populateDataRecords=function(t,e,r){var n=this;if(void 0===e&&(e={}),void 0===r&&(r={}),!t.data)return[];if(!Array.isArray(t.data))return this.populateDataRecord(t.data,e,r);var i=[];return t.data.forEach((function(t,s){var a=o(o({},r),{parents:r.parents?[o(o({},r.parents[0]),{position:s})]:[]});r.parents&&(r.parents[0].position=s);var u=n.populateDataRecord(t,e,a);i.push(u)})),i},e.prototype.populateDataRecord=function(t,e,r){var n=this;void 0===e&&(e={});var i=r.filter||this.filter,s=r.mapping||this.mapping;if(!i||i(t)){if(s){var a="function"===typeof s?s(t):ct(s,t);Object.assign(t,a)}var u=this._materializeRecord(e,o({id:t.id,type:t.type,extendRelationships:this._extendRelationships},r));return t.meta&&(u._meta=t.meta),t.attributes&&t.attributes.cachingPolicy&&t.attributes.cachingPolicy.maxAge&&(u._mjs.expiration=Date.now()+1e3*t.attributes.cachingPolicy.maxAge,this._removeOnExpiration&&this._expiryRecords.add(u)),this._populateDataAttributes(t,u),"object"===typeof t.relationships&&Object.keys(t.relationships).forEach((function(r){var i=t.relationships[r];i&&"data"in i&&(i=n.populateDataRecords(i,e,{mapping:s,parents:[{relationshipName:r,parentType:u.type,parentId:u.id}]}),u.setProperty(r,i,"relationships"))})),"object"===typeof t.views&&Object.keys(t.views).forEach((function(r){var i=t.views[r];if(i.attributes||i.data){var o=new At("view",r);if(n._populateDataAttributes(i,o),i.data){var a=n.populateDataRecords(i,e,s);o.setProperty("data",a,"relationships")}u.setProperty(r,o,"views")}})),u}},e.prototype.query=function(t,e){this._checkForExpiredRecords();var r=function(t){return!1};return"string"===typeof t&&e?r=function(r){return at(r,t)===e}:"function"===typeof t?r=function(e){try{return t(e)}catch(r){return!1}}:"object"===typeof t&&(r=function(e){var r=Object.keys(t),n=0;return r.forEach((function(r){at(e,r)===t[r]&&n++})),r.length===n}),Object.values(this._records).reduce((function(t,e){return Object.values(e).forEach((function(e){r(e)&&t.push(e)})),t}),[])},e.prototype.remove=function(t,e){var r=this;setTimeout(this._checkForExpiredRecords.bind(this),0);var n=this._records.hasOwnProperty(t);if(n){var i=this.peek(t,e);i&&(this.dispatchEvent(vt.dataRecordWillDelete,[t,e]),i["_mjs"].parents&&i["_mjs"].parents.length>0&&i["_mjs"].parents.forEach((function(t){var e=t.relationshipName,n=t.parentType,o=t.parentId,s=r.peek(n,o);s.removeRelative(e,i.id)})),delete this._records[t][e],this.dispatchEvent(vt.dataRecordDidDelete,[t,e]))}},e.prototype.save=function(t,e){return void 0===e&&(e={}),setTimeout(this._checkForExpiredRecords.bind(this),0),this.populateDataRecords(t,this._records,e)},e.prototype._populateDataAttributes=function(t,e){"object"===typeof t.attributes&&(this.dispatchEvent(vt.dataRecordWillPopulate,[e.type,e.id]),Object.keys(t.attributes).forEach((function(r){e.setProperty(r,t.attributes[r],"attributes")})),this.dispatchEvent(vt.dataRecordDidPopulate,[e.type,e.id]))},e.prototype._materializeRecord=function(t,e){var r=e.type,n=e.id,i=s(e,["type","id"]);return t[r]=t[r]||{},t[r][n]?t[r][n].setParent(i.parents||[]):t[r][n]=new At(r,n,i),this.dispatchEvent(vt.dataRecordDidMaterialize,[r,n]),t[r][n]},e.prototype._checkForExpiredRecords=function(){var t=this,e=[];this._expiryRecords.forEach((function(r){Date.now()>r["_mjs"].expiration&&(e.push([r.type,r.id]),t._expiryRecords.delete(r))})),e.forEach((function(e){t.remove.apply(t,d(e))}))},e}(dt);function It(t,e){if(void 0===e&&(e=25),t)return t.limit&&(t.limit=t.limit>e?e:t.limit),t}function kt(t){var e=Object.assign({},t),r=e.href;return void 0!==r&&(delete e.href,e.attributes=o(o({},e.attributes),{href:r})),e}var Ct="songs";function Dt(t){return t.map((function(t){return"string"===typeof t?{id:t,type:Ct}:{id:t.id,type:t.type||Ct}}))}function Nt(t){var e,r,n={};if(!t)return n;try{for(var i=c(t),o=i.next();!o.done;o=i.next()){var s=o.value;if(s){var a=s.type,u=s.id;a in n||(n[a]=[]),n[a].push(u)}}}catch(l){e={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return n}var jt,Mt=["extend","include","l","platform","views"],Ut=function(){function t(t){void 0===t&&(t={}),this.enableDataStore=!1,t.features&&t.features.hasOwnProperty("api-data-store")&&(this.enableDataStore=!!t.features["api-data-store"]),this.enableDataStore&&(this._store=t.store||new Pt,this._store.mapping=kt)}return Object.defineProperty(t.prototype,"hasDataStore",{get:function(){return this.enableDataStore&&void 0!==this._store},enumerable:!0,configurable:!0}),t.prototype.delete=function(t,e){this.hasDataStore&&this._store.remove(t,e)},t.prototype.read=function(t,e,r,n){n||"function"!==typeof r||(n=r,r=void 0);var i={};if(r&&(r.views&&(i.views=r.views),r.include&&(i.relationships=r.include)),this.hasDataStore){var o=[];r&&(o=Object.keys(r).reduce((function(t,e){return-1===Mt.indexOf(e)&&t.push([e,r[e]]),t}),o));var s=void 0;if(s=o&&1===o.length?this._store.query(o[0][0],o[0][1]):this._store.peek(t,e,i),Array.isArray(s)){if(!r&&s.length)return s}else if(s)return s}if("function"===typeof n)return n()},t.prototype.write=function(t){var e=this;return this._prepareDataForDataStore(t,(function(t){return e._store.save(t)}))},t.prototype.parse=function(t){var e=this;return this._prepareDataForDataStore(t,(function(t){return e._store.populateDataRecords(t,{})}))},t.prototype._prepareDataForDataStore=function(t,e){return this.hasDataStore?Array.isArray(t)?e({data:t}):Object.keys(t).reduce((function(r,n){var i=t[n];return i.hasOwnProperty("data")&&i.hasOwnProperty("href")&&(r[n]=e({data:i.data})),"meta"===n&&(r[n]=t[n]),r}),{}):t},t}(),Lt=function(){function t(t){if(this.token=t,!t||!/^[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}/i.test(t))throw new Error("Invalid token.");var e=l(t.split("."),2),r=e[0],n=e[1],i=this._decode(n),o=i.exp,s=i.iss;if(this.expiration=1e3*o,this.isExpired)throw new Error("Initialized with an expired token.");this.teamId=s;var a=this._decode(r).kid;this.keyId=a}return Object.defineProperty(t.prototype,"isExpired",{get:function(){return this.expiration<Date.now()},enumerable:!0,configurable:!0}),t.prototype._decode=function(t){return JSON.parse(v(t))},t}(),Bt=function(){function t(t){void 0===t&&(t={}),this._data=t}return t.prototype.clear=function(){this._data={}},t.prototype.getItem=function(t){return this._data[t]},t.prototype.removeItem=function(t){delete this._data[t]},t.prototype.setItem=function(t,e){this._data[t]=e},t}(),xt=function(t){return new t.constructor(t)};(function(t){t["JSON"]="application/json",t["FORM"]="application/x-www-form-urlencoded"})(jt||(jt={}));var zt,Gt="cache-mut",Vt=function(){function t(t,e){if(this.prefix="",this.method="GET",this.url=t,e=e||{},e.storage&&e.underlyingStorage)throw new Error("only pass storage OR underlyingStorage in sessionOptions to URLSession");var r=e.underlyingStorage||{};this.storage=e.storage||new Bt(r),this.ttl=e.ttl||3e5,this._fetch=e.fetch||fetch.bind(window),this._fetchOptions=o({},e.fetchOptions),this.headers=this._fetchOptions.headers||new Headers,delete this._fetchOptions.headers}return t.prototype.request=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,s,a,c,l,d,h,f,p;return u(this,(function(u){switch(u.label){case 0:return r||"object"!==typeof t||(r=e||{},e=t,t=void 0),r=o(o({method:this.method,headers:this.headers,reload:!1},this._fetchOptions),r),n=t?this.url+"/"+t:this.url,i=r.method,s=r.reload,a=void 0!==s&&s,c=r.useRawResponse,r.headers=this.buildHeaders(r),delete r.reload,delete r.useRawResponse,"GET"===i&&(l=m(e),l&&(n=n+"?"+l),!a&&(d=this.getCacheItem(n),d))?[2,Promise.resolve(d)]:(!e||"POST"!==i&&"PUT"!==i||(r.body=r.body||e,r.contentType===jt.FORM?(r.body=m(r.body),r.headers.set("Content-Type",jt.FORM)):(r.body=JSON.stringify(r.body),r.headers.set("Content-Type",jt.JSON))),[4,this._fetch(n,r)]);case 1:if(h=u.sent(),!h.ok)return[2,Promise.reject(h)];u.label=2;case 2:return u.trys.push([2,4,,5]),[4,h.json()];case 3:return f=u.sent(),[3,5];case 4:return u.sent(),f={},[3,5];case 5:return f.errors?[2,Promise.reject(f.errors)]:(p=c?f:f.results||f.data||f,"GET"===i&&this.setCacheItem(n,p),[2,p])}}))}))},t.prototype.buildHeaders=function(t){var e=void 0===t?{}:t,r=e.headers,n=e.reload,i=void 0!==n&&n;"undefined"===typeof r&&(r=this.headers);var o=xt(r);return i&&o.set("Cache-Control","no-cache"),o},t.prototype.clearCacheItems=function(t){var e=this,r=this.storage.constructor===Bt?this.storage._data:this.storage;if(t)t.forEach((function(t){e.storage.removeItem(e._key(t))}));else{var n=new RegExp("^"+this.prefix);Object.keys(r).forEach((function(t){n.test(t)&&e.storage.removeItem(t)}))}},t.prototype.getCacheItem=function(t){var e=""+this.prefix+this.prefix+Gt,r=this.storage.getItem(e)||null,n=this.headers.get("Music-User-Token")||this.headers.get("Media-User-Token")||null;n!==r&&(this.clearCacheItems(),null===n?this.storage.removeItem(e):this.storage.setItem(e,n));var i=this._key(t),o=this.storage.getItem(i);if(o){var s=JSON.parse(o),a=s.x,u=s.d;if(a>Date.now())return u;this.storage.removeItem(i)}},t.prototype.setCacheItem=function(t,e,r){void 0===r&&(r=this.ttl);var n=this._key(t);this.storage.removeItem(n),this.storage.setItem(n,JSON.stringify({x:Date.now()+r,d:e}))},t.prototype._key=function(t){var e=g(t).toLowerCase().replace(this.url,"");return""+this.prefix+e.replace(/[^-_0-9a-z]{1,}/g,".")},t}(),Ft=function(t){function e(e,r,n){var i=t.call(this,e,n)||this;return i._developerToken=new Lt(r),i.headers.set("Authorization","Bearer "+i.developerToken),n=n||{},i.userToken=n.userToken,i.userToken&&i.headers.set("Music-User-Token",i.userToken),i}return i(e,t),Object.defineProperty(e.prototype,"developerToken",{get:function(){return this._developerToken.token},enumerable:!0,configurable:!0}),e}(Vt);function Ht(t){return t.replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()}(function(t){t["ID"]="us",t["LANGUAGE_TAG"]="en-gb"})(zt||(zt={}));var Kt=24e5,qt="";function Wt(t){var e;return(null===(e=t.artwork)||void 0===e?void 0:e.url)+qt+t.artistName+qt+t.name}var Zt,Jt,Yt=function(){function t(t,e,r){this._data=this._initData(),this._catalogApi=e,this._storageKey="mk-server-ledger:"+(t||""),this._sessionStorage=r||("undefined"!==typeof sessionStorage?sessionStorage:void 0),this.load()}return t.prototype._initData=function(){return{lastTimestamp:0,albums:{added:Object.create(null),removed:Object.create(null)},playlists:{added:Object.create(null),removed:Object.create(null)}}},t.prototype._checkTimestamp=function(){var t=this._data.lastTimestamp;t&&t+Kt<Date.now()&&(this._data=this._initData(),this._sessionStorage&&this._sessionStorage.removeItem(this._storageKey))},t.prototype.added=function(t){var e=this;this.load();var r=null===t||void 0===t?void 0:t.playlists,n=null===t||void 0===t?void 0:t.albums;return r||n?(r&&r.forEach((function(t){var r=Date.now();e._data.playlists.added[t]=r,e._data.lastTimestamp=r})),n&&n.forEach((function(t){var r=Date.now();e._data.albums.added[t]=r,e._data.lastTimestamp=r})),this.save(),t):t},t.prototype.removed=function(t){var e=this;this.load();var r=null===t||void 0===t?void 0:t.playlists;return r?(st(r).forEach((function(t){if(0!==t.indexOf("pl.")){var r=Date.now();e._data.playlists.removed[t]=r,e._data.lastTimestamp=r}})),this.save(),t):t},t.prototype.reconcile=function(t,e,r,n,i){var o,s;return a(this,void 0,void 0,(function(){var i,a,c,l,h,f,p,v,y,m,g,b,_,w,E,T,S,R,O=this;return u(this,(function(u){switch(u.label){case 0:if(this._checkTimestamp(),i=e["data"]||e,!i||!Array.isArray(i)||Array.isArray(r))return[2,e];if(a=this._data.albums.added,c=this._data.playlists.removed,l=this._data.playlists.added,h=[],f=n&&!n.offset||!!r&&(void 0===r["offset"]||0===r["offset"]),p=!1,"all"!==t&&"playlists"!==t)return[3,2];for(_=i.length-1;_>=0;_--)w=i[_],E=null===(o=w["playParams"])||void 0===o?void 0:o.globalId,"library-playlists"===w.type&&(c[w.id]?i.splice(_,1):E&&l[E]&&(delete l[E],p=!0,f||i.splice(_,1)));return f&&this._catalogApi?(v=Object.keys(l),v.length?[4,this._catalogApi.playlists(v)]:[3,2]):[3,2];case 1:y=u.sent(),h.splice.apply(h,d([0,0],y)),u.label=2;case 2:return!this._catalogApi||"all"!==t&&"albums"!==t?[3,4]:(m=Object.keys(a),m.length?[4,this._catalogApi.albums(m)]:[3,4]);case 3:for(g=u.sent(),b=Object.create(null),g.forEach((function(t,e){var r=Wt(t);b[r]={catalogId:m[e],album:t}})),_=i.length-1;_>=0;_--)w=i[_],E=null===(s=w["playParams"])||void 0===s?void 0:s.globalId,"library-albums"===w.type&&(T=Wt(w),S=b[T],S&&(delete a[S.catalogId],p=!0,f?delete b[T]:i.splice(_,1)));f&&(R=Object.keys(b).map((function(t){return b[t].album})),R.length&&h.splice.apply(h,d([0,0],R))),u.label=4;case 4:return p&&this.save(),f&&h.length&&(h.sort((function(t,e){var r=O._data.albums.added[t.id]||O._data.playlists.added[t.id]||0,n=O._data.albums.added[e.id]||O._data.playlists.added[e.id]||0;return n-r})),i.splice.apply(i,d([0,0],h))),[2,e]}}))}))},t.prototype.load=function(){if(this._sessionStorage){var t=this._sessionStorage.getItem(this._storageKey);if(t)try{this._data=JSON.parse(t),this._data.albums&&this._data.playlists||(this._data=this._initData())}catch(e){this._data||(this._data=this._initData())}else this._data=this._initData()}},t.prototype.save=function(){if(this._sessionStorage){var t=this._data,e=0===Object.keys(t.albums.added).length&&0===Object.keys(t.albums.removed).length&&0===Object.keys(t.playlists.added).length&&0===Object.keys(t.playlists.removed).length;try{if(e)this._sessionStorage.getItem(this._storageKey)&&this._sessionStorage.removeItem(this._storageKey);else{var r=JSON.stringify(this._data);this._sessionStorage.setItem(this._storageKey,r)}}catch(n){}}},t}(),Qt="me/library",Xt=function(t){function e(e,r,n,i,s,a){void 0===i&&(i={});var u=t.call(this,e,r,o(o({},a),{userToken:n}))||this;return u._last=0,u._store=new Ut(i),u._serverLedger=new Yt(n,s),u.defaultIncludePaginationMetadata=i.features&&i.features.hasOwnProperty("api-pagination-metadata"),u}return i(e,t),e.prototype.add=function(t){return a(this,void 0,void 0,(function(){var e,r,n,i,o;return u(this,(function(s){switch(s.label){case 0:if(e=lt(t,Ht),r=Date.now(),r-this._last<1e3)return[2,Promise.reject(new X(X.QUOTA_EXCEEDED))];n=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),i=Object.keys(e).map((function(t){return"ids["+t+"]="+e[t].join(",")})).join("&"),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(this.url+"/"+Qt+"?"+i,{method:"POST",headers:n})];case 2:return s.sent(),this._last=r,[2,this._serverLedger.added(e)];case 3:return o=s.sent(),[2,Promise.reject(X.responseError(o))];case 4:return[2]}}))}))},e.prototype.remove=function(t){return a(this,void 0,void 0,(function(){var e,r,n,i,o;return u(this,(function(s){switch(s.label){case 0:if(!this.developerToken||!this.userToken)return[2,Promise.reject("Invalid tokens")];e=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken}),r=lt(t,Ht),n=Object.keys(r)[0],i=Object.values(r)[0],s.label=1;case 1:return s.trys.push([1,3,,4]),[4,fetch(this.url+"/"+Qt+"/"+n+"/"+i,{method:"DELETE",headers:e})];case 2:return s.sent(),[2,this._serverLedger.removed(r)];case 3:return o=s.sent(),[2,Promise.reject(X.responseError(o))];case 4:return[2]}}))}))},e.prototype.album=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource("albums",t,e,r)]}))}))},e.prototype.albumRelationship=function(t,e,r,n){return a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection("albums/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.albums=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){switch(i.label){case 0:return[4,this.collection("albums",t,e,r,!1)];case 1:return n=i.sent(),[2,this._serverLedger.reconcile("albums",n,t,e,r)]}}))}))},e.prototype.artist=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource("artists",t,e,r)]}))}))},e.prototype.artistRelationship=function(t,e,r,n){return void 0===e&&(e="albums"),a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection("artists/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.artists=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection("artists",t,e,r)]}))}))},e.prototype.createPlaylist=function(t,e){return void 0===t&&(t={}),a(this,void 0,void 0,(function(){var r,n,i,o,s,a,c,d,h,f,p;return u(this,(function(u){switch(u.label){case 0:n=t.name,i=t.description,o=t.tracks,s=void 0===o?[]:o,a=Dt(s),c={attributes:{name:n,description:i},relationships:{tracks:{data:a}}},d=JSON.stringify(c),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.request(Qt+"/playlists",e,{body:d,method:"POST"})];case 2:return r=u.sent(),[3,4];case 3:return h=u.sent(),[2,Promise.reject(X.responseError(h))];case 4:try{return f=l(this._store.write(r),1),p=f[0],[2,p]}catch(v){return[2,Promise.reject(X.parseError(v))]}return[2]}}))}))},e.prototype.deletePlaylist=function(t,e){return a(this,void 0,void 0,(function(){var r;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.request(Qt+"/playlists/"+t,e,{method:"DELETE"})];case 1:return n.sent(),[3,3];case 2:return r=n.sent(),[2,Promise.reject(X.responseError(r))];case 3:try{this._store.delete("library-playlists",t)}catch(i){return[2,Promise.reject(X.parseError(i))]}return[2]}}))}))},e.prototype.editPlaylist=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,o,s;return u(this,(function(a){switch(a.label){case 0:n=JSON.stringify({attributes:e}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.request(Qt+"/playlists/"+t,r,{body:n,method:"PATCH"})];case 2:return a.sent(),[3,4];case 3:return i=a.sent(),[2,Promise.reject(X.responseError(i))];case 4:try{return o=e,s="library-playlists",this._store.write({data:[{type:s,id:t,attributes:o}]}),[2,e]}catch(u){return[2,Promise.reject(X.parseError(u))]}return[2]}}))}))},e.prototype.updatePlaylistTracklist=function(t,e){return a(this,void 0,void 0,(function(){var r,n;return u(this,(function(i){switch(i.label){case 0:return[4,this.playlist(t)];case 1:return r=i.sent(),[4,this.putPlaylistTracklisting(t,e)];case 2:return i.sent(),n=r,r instanceof At&&(n=r.serialize().data),n.relationships.tracks={data:e},[2,this._store.write([n])[0]]}}))}))},e.prototype.musicVideo=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource("music-videos",t,e,r)]}))}))},e.prototype.musicVideos=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection("music-videos",t,e,r)]}))}))},e.prototype.parseResultData=function(t,e){return t?this._store.write(e):this._store.parse(e)},e.prototype.playlist=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=Object.assign({include:"tracks"},e),[2,this.resource("playlists",t,e,r)]}))}))},e.prototype.playlistRelationship=function(t,e,r,n){return void 0===e&&(e="tracks"),a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection("playlists/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.playlists=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){switch(i.label){case 0:return[4,this.collection("playlists",t,e,r,!1)];case 1:return n=i.sent(),[2,this._serverLedger.reconcile("playlists",n,t,e,r)]}}))}))},e.prototype.recentlyAdded=function(t,e){return a(this,void 0,void 0,(function(){var r,n;return u(this,(function(i){switch(i.label){case 0:return r=t&&t.limit,[4,this.collection("recently-added",void 0,It(t,r||10),e,!1)];case 1:return n=i.sent(),[2,this._serverLedger.reconcile("all",n,void 0,t,e)]}}))}))},e.prototype.search=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return e=this._denormalizeLibraryTypes(e),n=Object.assign({term:t,types:"library-albums"},e),[2,this.collection("search",void 0,n,r,!1)]}))}))},e.prototype.song=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource("songs",t,e,r)]}))}))},e.prototype.songs=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection("songs",t,e,r)]}))}))},e.prototype.collection=function(t,e,r,n,i){return void 0===i&&(i=!0),a(this,void 0,void 0,(function(){var o;return u(this,(function(s){return!e||e.length||r||(r=It(e,100),e=void 0),o=e?Object.assign({ids:e},r):r,[2,nt(this,Qt+"/"+t,o,n,i)]}))}))},e.prototype.resource=function(t,e,r,n){return a(this,void 0,void 0,(function(){var i,o,s;return u(this,(function(a){switch(a.label){case 0:return i=this._store.read(t,e,r),i?[2,i]:[4,nt(this,Qt+"/"+t+"/"+e,r,n)];case 1:return o=l.apply(void 0,[a.sent(),1]),s=o[0],[2,s]}}))}))},e.prototype.putPlaylistTracklisting=function(t,e){return a(this,void 0,void 0,(function(){var r,n,i;return u(this,(function(o){switch(o.label){case 0:r=Dt(e),n=JSON.stringify({data:r}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.request(Qt+"/playlists/"+t+"/tracks",void 0,{body:n,method:"PUT"})];case 2:return o.sent(),[3,4];case 3:return i=o.sent(),[2,Promise.reject(X.responseError(i))];case 4:return[2]}}))}))},e.prototype._denormalizeLibraryTypes=function(t,e){void 0===t&&(t={}),void 0===e&&(e="types");var r=t[e];return r?("string"===typeof r&&(r=r.split(",")),t[e]=r.map((function(t){return t.replace(/^(albums|music-videos|playlists|songs)$/,"library-$1")})),t):t},e}(Ft),$t=function(t){void 0===t&&(t=new Date);var e=t.getTimezoneOffset(),r=Math.floor(Math.abs(e)/60),n=Math.round(Math.abs(e)%60),i="";return 0!==e&&(i=e>0?"-":"+"),""+i+te(r,2)+":"+te(n,2)},te=function(t,e){void 0===e&&(e=2);var r=""+t;while(r.length<e)r="0"+r;return r},ee=function(t){function e(e,r,n,i,s){void 0===i&&(i={});var a=t.call(this,"https://amp-api.podcasts.apple.com/v1",e,o(o({},s),{userToken:r,storage:n}))||this;return a.storefrontId=zt.ID,a._store=new Ut(i),a.defaultIncludePaginationMetadata=i.features&&i.features.hasOwnProperty("api-pagination-metadata"),a}return i(e,t),e.prototype.charts=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection("charts",t,e,r)]}))}))},e.prototype.podcast=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=Object.assign({include:"episodes"},e),[2,this.resource("podcasts",t,n,r)]}))}))},e.prototype.podcasts=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=Object.assign({include:"episodes"},e),[2,this.collection("podcasts",t,n,r)]}))}))},e.prototype.search=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=Object.assign({term:t,types:"podcasts"},e),[2,this.collection("search",void 0,n,r)]}))}))},e.prototype.episode=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource("podcast-episodes",t,e,r)]}))}))},e.prototype.episodes=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection("podcast-episodes",t,e,r)]}))}))},e.prototype.collection=function(t,e,r,n){return a(this,void 0,void 0,(function(){var i,o,s;return u(this,(function(a){return e?(o={},o["charts"===t?"types":"ids"]=e,i=Object.assign(o,r)):i=r,s="catalog/"+this.storefrontId+"/"+t,[2,nt(this,s,i,n)]}))}))},e.prototype.parseResultData=function(t,e){return t?this._store.write(e):this._store.parse(e)},e.prototype.resource=function(t,e,r,n){return a(this,void 0,void 0,(function(){var i,o,s;return u(this,(function(a){switch(a.label){case 0:return i=this._store.read(t,e,r),i?[2,i]:[4,this.collection(t,e,r,n)];case 1:return o=l.apply(void 0,[a.sent(),1]),s=o[0],[2,s]}}))}))},e}(Ft);(function(t){t[t["Global"]=0]="Global",t["Catalog"]="catalog",t["Personalized"]="me",t["Editorial"]="editorial",t["Social"]="social"})(Zt||(Zt={})),function(t){t["songs"]="songs",t["albums"]="albums",t["playlists"]="playlists",t["stations"]="stations",t["music-videos"]="music-videos",t["library-music-videos"]="library-music-videos",t["library-playlists"]="library-playlists",t["library-songs"]="library-songs"}(Jt||(Jt={}));var re="desktop",ne=["search/hints","recommendations","charts"],ie=function(t){function e(e,r,n,i,s,a,u,c){void 0===u&&(u={});var l=t.call(this,e,r,o(o({},c),{userToken:i,storage:a}))||this;return l.storefrontId=zt.ID,l.enablePlayEquivalencies=!0,l.resourceRelatives={artists:{albums:{include:"tracks"},playlists:{include:"tracks"},songs:null}},u.features&&u.features.hasOwnProperty("equivalencies")&&(l.enablePlayEquivalencies=u.features["equivalencies"]),l.defaultIncludePaginationMetadata=u.features&&u.features.hasOwnProperty("api-pagination-metadata"),l._store=new Ut(u),n&&(l.storefrontId=n),i&&s&&(l.userStorefrontId=s),l._podcastsAPI=new ee(r,i,a,u,o({},c)),l.library=new Xt(e,r,i,u,l,o({},c)),l}return i(e,t),Object.defineProperty(e.prototype,"needsEquivalents",{get:function(){return this.userStorefrontId&&this.userStorefrontId!==this.storefrontId},enumerable:!0,configurable:!0}),e.prototype.activity=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"activities",t,e,r)]}))}))},e.prototype.activities=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"activities",t,e,r)]}))}))},e.prototype.album=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=this.equivalentParameters(e,"extend[songs]"),[2,this.resource(Zt.Catalog,"albums",t,e,r,!0,!0)]}))}))},e.prototype.albumRelationship=function(t,e,r,n){return a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection(Zt.Catalog,"albums/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.albums=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=this.equivalentParameters(e,"extend[songs]"),[2,this.collection(Zt.Catalog,"albums",t,e,r,!0,!0)]}))}))},e.prototype.appleCurator=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"apple-curators",t,e,r)]}))}))},e.prototype.appleCurators=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"apple-curators",t,e,r)]}))}))},e.prototype.artist=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"artists",t,e,r)]}))}))},e.prototype.artistRelationship=function(t,e,r,n){return a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection(Zt.Catalog,"artists/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.artistView=function(t,e,r,n){return this.collection(Zt.Catalog,"artists/"+t+"/view/"+e,void 0,r,n)},e.prototype.artists=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"artists",t,e,r)]}))}))},e.prototype.catalogResources=function(t,e,r){void 0===e&&(e={});var n=Nt(t);return e=o(o({},e),{ids:n}),nt(this,Zt.Catalog+"/"+this.storefrontId,e,r)},e.prototype.charts=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"charts",t,e,r)]}))}))},e.prototype.curator=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"contents",t,e,r)]}))}))},e.prototype.curators=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"contents",t,e,r)]}))}))},e.prototype.episode=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this._podcastsAPI.episode(t,e,r)]}))}))},e.prototype.episodes=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this._podcastsAPI.episodes(t,e,r)]}))}))},e.prototype.genre=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"genres",t,e,r)]}))}))},e.prototype.genres=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"genres",t,e,r)]}))}))},e.prototype.grouping=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i;return u(this,(function(s){return!e&&t&&t.constructor===Object&&(e=t,t=void 0),n={platform:re},i=o(o({},n),e),[2,this.resource(Zt.Editorial,"groupings",t,i,r,!1)]}))}))},e.prototype.groupings=function(t,e,r){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,i;return u(this,(function(s){return n={platform:re},i=o(o({},n),e),[2,this.collection(Zt.Editorial,"groupings",t,i,r,!1)]}))}))},e.prototype.historyHeavyRotation=function(t,e){return a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.collection(Zt.Personalized,"history/heavy-rotation",void 0,It(t,10),e)]}))}))},e.prototype.multiroom=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,o;return u(this,(function(s){switch(s.label){case 0:return n=this._store.read("multirooms",t,e),n?[2,n]:[4,this.collection(Zt.Editorial,"multirooms/"+t,void 0,e,r)];case 1:return i=l.apply(void 0,[s.sent(),1]),o=i[0],[2,o]}}))}))},e.prototype.musicMovie=function(t,e,r){return this.resource(Zt.Catalog,"music-movies",t,e,r)},e.prototype.musicMovies=function(t,e,r){return this.collection(Zt.Catalog,"music-movies",t,e,r)},e.prototype.musicVideo=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=this.equivalentParameters(e),[2,this.resource(Zt.Catalog,"music-videos",t,e,r)]}))}))},e.prototype.musicVideos=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=this.equivalentParameters(e),[2,this.collection(Zt.Catalog,"music-videos",t,e,r)]}))}))},e.prototype.nextStationTracks=function(t,e,r){return void 0===r&&(r={}),a(this,void 0,void 0,(function(){var n;return u(this,(function(i){switch(i.label){case 0:return[4,nt(this,"me/stations/next-tracks/"+t,e,o(o({},r),{reload:!0,method:"POST"}),!1)];case 1:return n=i.sent(),[2,n]}}))}))},e.prototype.playlist=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"playlists",t,e,r,!0,!0)]}))}))},e.prototype.playlistRelationship=function(t,e,r,n){return a(this,void 0,void 0,(function(){return u(this,(function(i){return[2,this.collection(Zt.Catalog,"playlists/"+t+"/"+e,void 0,r,n)]}))}))},e.prototype.playlists=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Catalog,"playlists",t,e,r,!0,!0)]}))}))},e.prototype.podcast=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this._podcastsAPI.podcast(t,e,r)]}))}))},e.prototype.podcasts=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this._podcastsAPI.podcasts(t,e,r)]}))}))},e.prototype.recentPlayed=function(t,e){return a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.collection(Zt.Personalized,"recent/played",void 0,It(t,10),e)]}))}))},e.prototype.recentRadioStations=function(t,e){return a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.collection(Zt.Personalized,"recent/radio-stations",void 0,It(t,10),e)]}))}))},e.prototype.recommendation=function(t,e,r,n){return void 0===n&&(n=!0),a(this,void 0,void 0,(function(){var i,o,s;return u(this,(function(a){switch(a.label){case 0:return[4,this.recommendations(t,e,r,n)];case 1:return i=a.sent(),o=l(i,1),s=o[0],[2,s]}}))}))},e.prototype.recommendations=function(t,e,r,n){return void 0===r&&(r={}),void 0===n&&(n=!0),a(this,void 0,void 0,(function(){var i,s;return u(this,(function(a){switch(a.label){case 0:return i=$t(),[4,this.collection(Zt.Personalized,"recommendations",t,o({timezone:i},e),r,n)];case 1:s=a.sent(),this._reindexRelationships(s,"recommendations");try{return[2,this.parseResultData(!1,s)]}catch(u){return[2,Promise.reject(X.parseError(u))]}return[2]}}))}))},e.prototype.room=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,o,s;return u(this,(function(a){switch(a.label){case 0:return n=this._store.read("rooms",t,e),n&&n.hasAttributes("title")?[2,n]:[4,this.collection(Zt.Editorial,"rooms/"+t,void 0,e,r)];case 1:return i=a.sent(),o=l(i,1),s=o[0],[2,s]}}))}))},e.prototype.roomContents=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Editorial,"rooms/"+t+"/contents",void 0,e,r)]}))}))},e.prototype.search=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=Object.assign({term:t},It(e)),r=o(o({},r),{useRawResponse:!0}),[2,this.collection(Zt.Catalog,"search",void 0,n,r,!1)]}))}))},e.prototype.searchHints=function(t,e,r){return a(this,void 0,void 0,(function(){var n;return u(this,(function(i){return n=Object.assign({term:t},It(e)),[2,this.collection(Zt.Catalog,"search/hints",void 0,n,r)]}))}))},e.prototype.socialProfile=function(t,e,r){return this.resource(Zt.Social,"social-profiles",t,e,r)},e.prototype.socialProfiles=function(t,e,r){return this.collection(Zt.Social,"social-profiles",t,e,r)},e.prototype.socialPost=function(t,e,r){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){var n,i;return u(this,(function(o){switch(o.label){case 0:return t.startsWith("sa.")?e.filter={post:t}:e.ids=t,[4,this.collection(Zt.Catalog,"contents","",e,r)];case 1:return n=l.apply(void 0,[o.sent(),1]),i=n[0],[2,i]}}))}))},e.prototype.song=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=this.equivalentParameters(e),[2,this.resource(Zt.Catalog,"songs",t,e,r,!0,!0)]}))}))},e.prototype.songs=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return!e&&t&&t.constructor===Object&&(e=t,t=void 0),e=this.equivalentParameters(e),[2,this.collection(Zt.Catalog,"songs",t,e,r,!0,!0)]}))}))},e.prototype.tastePreferences=function(t,e){return a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.collection(Zt.Personalized,"taste/taste-preferences",void 0,t,e,!1)]}))}))},e.prototype.saveTastePreferences=function(t){return a(this,void 0,void 0,(function(){var e,r;return u(this,(function(n){switch(n.label){case 0:t=t.map((function(t){return t instanceof At?t.serialize().data:t})),e={method:"POST",body:JSON.stringify({data:t})},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,nt(this,"me/taste/taste-preferences",void 0,e,!1)];case 2:return[2,n.sent()];case 3:return r=n.sent(),"CONTENT_UNAVAILABLE"===r.name?[2,[]]:[2,Promise.reject(X.parseError(r))];case 4:return[2]}}))}))},e.prototype.tvEpisode=function(t,e,r){return this.resource(Zt.Catalog,"tv-episodes",t,o({include:"seasons"},e),r)},e.prototype.tvEpisodes=function(t,e,r){return this.collection(Zt.Catalog,"tv-episodes",t,o({include:"seasons"},e),r)},e.prototype.tvSeason=function(t,e,r){return this.resource(Zt.Catalog,"tv-seasons",t,o({include:"episodes"},e),r)},e.prototype.tvSeasons=function(t,e,r){return this.collection(Zt.Catalog,"tv-seasons",t,o({include:"episodes"},e),r)},e.prototype.tvShow=function(t,e,r){return this.resource(Zt.Catalog,"tv-shows",t,e,r)},e.prototype.tvShows=function(t,e,r){return this.collection(Zt.Catalog,"tv-shows",t,e,r)},e.prototype.uploadedAudio=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=Object.assign({include:"curator,artists"},e),[2,this.resource(Zt.Catalog,"uploaded-audios",t,e,r)]}))}))},e.prototype.uploadedAudios=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=Object.assign({include:"curator,artists"},e),[2,this.collection(Zt.Catalog,"uploaded-audios",t,e,r)]}))}))},e.prototype.uploadedVideo=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=Object.assign({include:"curator,artists"},e),[2,this.resource(Zt.Catalog,"uploaded-videos",t,e,r)]}))}))},e.prototype.uploadedVideos=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return e=Object.assign({include:"curator,artists"},e),[2,this.collection(Zt.Catalog,"uploaded-videos",t,e,r)]}))}))},e.prototype.station=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Catalog,"stations",t,e,r)]}))}))},e.prototype.stations=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return!e&&t&&t.constructor===Object&&(e=t,t=void 0),[2,this.collection(Zt.Catalog,"stations",t,e,r)]}))}))},e.prototype.storefront=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Global,"storefronts",t,e,r)]}))}))},e.prototype.storefronts=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.collection(Zt.Global,"storefronts",t,e,r)]}))}))},e.prototype.musicSummary=function(t,e,r){return a(this,void 0,void 0,(function(){return u(this,(function(n){return[2,this.resource(Zt.Personalized,"music-summaries",t,e,r)]}))}))},e.prototype.musicSummarySearch=function(t,e){return void 0===t&&(t={}),a(this,void 0,void 0,(function(){return u(this,(function(r){return[2,this.collection(Zt.Personalized,"music-summaries/search",void 0,t,e)]}))}))},e.prototype.addToLibrary=function(t){return a(this,void 0,void 0,(function(){return u(this,(function(e){return this.developerToken&&this.userToken&&this.library?[2,this.library.add(t)]:[2,Promise.reject("Invalid tokens")]}))}))},e.prototype.rating=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i;return u(this,(function(o){switch(o.label){case 0:return[4,this.ratings(t,e,r)];case 1:return n=l.apply(void 0,[o.sent(),1]),i=n[0],[2,i]}}))}))},e.prototype.ratings=function(t,e,r){if(!this.developerToken||!this.userToken)return Promise.reject("Invalid tokens");var n=l(Object.keys(t),1),i=n[0],s=t[i],a=Array.isArray(s);if(a&&0===s.length)return Promise.resolve([]);var u=et(i,a?s[0]:s),c="me/ratings/"+u;return a?e=o(o({},e),{ids:s}):c=c+"/"+s,nt(this,c,e,o({reload:!0,includePagination:!1},r),!1)},e.prototype.putRating=function(t,e,r){return a(this,void 0,void 0,(function(){var n,i,o,s,a,c,d,h;return u(this,(function(u){switch(u.label){case 0:return this.developerToken&&this.userToken?(n=l(Object.keys(t),1),i=n[0],o=t[i],s=et(i,o),a={method:"PUT",body:JSON.stringify({type:"rating",attributes:{value:e}}),includePagination:!1},[4,nt(this,"me/ratings/"+s+"/"+o,r,a,!1)]):[2,Promise.reject("Invalid tokens")];case 1:return c=u.sent(),d=l(c,1),h=d[0],[2,h]}}))}))},e.prototype.deleteRating=function(t,e){return a(this,void 0,void 0,(function(){var r,n,i,o;return u(this,(function(s){switch(s.label){case 0:return this.developerToken&&this.userToken?(r=l(Object.keys(t),1),n=r[0],i=t[n],o=et(n,i),[4,nt(this,"me/ratings/"+o+"/"+i,e,{method:"DELETE"},!1,!0)]):[2,Promise.reject("Invalid tokens")];case 1:s.sent();try{this._store.delete(o,i)}catch(a){return[2,Promise.reject(X.parseError(a))]}return[2]}}))}))},e.prototype.collection=function(t,e,r,n,i,s,c){return void 0===s&&(s=!0),void 0===c&&(c=!1),a(this,void 0,void 0,(function(){var a,l,d,h,f;return u(this,(function(u){switch(a=r?o((f={},f["charts"===e?"types":"ids"]=r,f),n):n,t){case Zt.Catalog:case Zt.Editorial:case Zt.Social:d=this.storefrontId,this.needsEquivalents&&"playlists"===e&&(d=this.userStorefrontId),l=t+"/"+d+"/"+e;break;case Zt.Global:l=e;break;case Zt.Personalized:l=t+"/"+e,s=!1;break}return h=ne.some((function(t){return null!==l.match(t)})),[2,nt(this,l,a,i,s,h,c)]}))}))},e.prototype.parseResultData=function(t,e){return t?this._store.write(e):this._store.parse(e)},e.prototype.resource=function(t,e,r,n,i,o,s){return void 0===o&&(o=!0),void 0===s&&(s=!1),a(this,void 0,void 0,(function(){var a,c,d;return u(this,(function(u){switch(u.label){case 0:return a=this._store.read(e,r,n),a?[2,a]:[4,this.collection(t,e,r,n,i,o,s)];case 1:return c=l.apply(void 0,[u.sent(),1]),d=c[0],[2,d]}}))}))},e.prototype.equivalentParameters=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e="extend"),!this.needsEquivalents||!this.userStorefrontId)return t;var r={equivalentStorefronts:this.userStorefrontId};return this.enablePlayEquivalencies?r[e]="equivalentPlayParams":r["include"]="equivalents",Object.assign(t,r)},e.prototype._reindexRelationships=function(t,e){t.forEach((function(t){t.hasOwnProperty("relationships")&&t.relationships.hasOwnProperty(e)&&t.relationships[e].hasOwnProperty("data")&&Array.isArray(t.relationships[e].data)&&t.relationships[e].data.forEach((function(t,e){t.id=t.id+"-"+e}))}))},e}(Ft)},48753:function(t,e){"use strict";var r,n=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s};function i(t){return void 0===t&&(t={app:r.APP,p:r.P}),"undefined"===typeof t.app&&(t.app=r.APP),"undefined"===typeof t.p&&(t.p=r.P),Object.keys(t).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])})).join("&")}function o(t){if(!t)return{};-1!==t.indexOf("?")&&(t=t.substr(t.indexOf("?")).replace("?",""));var e=t.split("&");return e.reduce((function(t,e){var r=n(e.split("="),2),i=r[0],o=r[1];return t[i]=o?decodeURIComponent(o.replace(/\+/g," ")):"",t}),{})}Object.defineProperty(e,"__esModule",{value:!0}),function(t){t["APP"]="music",t["P"]="subscribe"}(r=e.Defaults||(e.Defaults={})),e.buildQueryParams=i,e.parseQueryParams=o},42476:(t,e)=>{"use strict";var r,n;Object.defineProperty(e,"__esModule",{value:!0}),e.SKRealmBundle=(r={},r[2]="com.apple.onboarding.tvapp",r[0]="com.apple.onboarding.applemusic",r),e.SKRealmCidNamespace=(n={},n[2]="pltvcid",n[0]="pldfltcid",n),e.SKRequiredPrivacyVersion={"com.apple.onboarding.tvapp":5,"com.apple.onboarding.applemusic":3}},44860:function(t,e,r){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)},i=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(s)try{if(r=1,n&&(i=2&o[0]?n["return"]:o[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},s=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var u,c,l=r(40565),d=r(48753);function h(t){var e;if("string"!==typeof t)return!1;var r=t.match(/[a-zA-Z0-9=\/+]{32,}==$/);return null!==(e=r&&r.length>0)&&void 0!==e&&e}(function(t){t[t["UNAVAILABLE"]=-1]="UNAVAILABLE",t[t["NOT_DETERMINED"]=0]="NOT_DETERMINED",t[t["DENIED"]=1]="DENIED",t[t["RESTRICTED"]=2]="RESTRICTED",t[t["AUTHORIZED"]=3]="AUTHORIZED"})(u=e.AuthorizationStatus||(e.AuthorizationStatus={})),e.validateToken=h,e.ACTIVATE_REQUEST_URL="https://activate.apple.com/mkauth",e.AUTHENTICATE_REQUEST_URL="https://buy.itunes.apple.com/commerce/account/authenticateMusicKitRequest",e.SERVICE_URL="https://authorize.music.apple.com",e.SUBSCRIBE_URL=e.SERVICE_URL+"/upsell",e.WHITELIST_DOMAIN_REGEX=/^https?:\/\/(.+\.)*(apple\.com|apps\.mzstatic\.com)(\/[\w\d]+)*$/,function(t){t[t["AUTHORIZE"]=0]="AUTHORIZE",t[t["SUBSCRIBE"]=1]="SUBSCRIBE"}(c=e.ServiceSetupAction||(e.ServiceSetupAction={}));var f=function(){function t(t,e){void 0===e&&(e={}),this.developerToken=t,this.authenticateMethod="GET",this.target="apple-music-service-view",this.deeplinkParameters=e&&e.deeplinkParameters||{},this.iconURL=e&&e.iconURL,this.authenticateMethod=e&&e.authenticateMethod||"GET",this.isServiceView&&window.opener!==window&&(this.dispatch=new l.Dispatch({destination:window.opener,origin:"*",source:window}))}return Object.defineProperty(t.prototype,"isServiceView",{get:function(){return/(authorize\.(.+\.)*apple\.com)/i.test(window.location.hostname)||window&&window.name===this.target||!1},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._window&&window.focus&&this._window.focus()},t.prototype.load=function(t){return void 0===t&&(t={action:c.AUTHORIZE}),i(this,void 0,void 0,(function(){return o(this,(function(e){return t.action===c.SUBSCRIBE?[2,this._subscribeAction(t.parameters)]:[2,this._authorizeAction(t.parameters)]}))}))},t.prototype.present=function(t,e){void 0===t&&(t="");var r=this._calculateClientDimensions(),i=r.height,o=r.left,s=r.top,a=r.width,u={height:650,menubar:"no",resizable:"no",scrollbars:"no",status:"no",toolbar:"no",width:650},c=n(n(n({},u),{left:a/2-u.width/2+o,top:i/2-u.height/2+s}),e),l=Object.keys(c).map((function(t){return t+"="+c[t]})).join(",");return/trident|msie/i.test(navigator.userAgent)?(this._window=window.open(window.location.href,this.target,l)||void 0,this._window.location.href=t):this._window=window.open(t,this.target,l)||void 0,/\bedge\b/i.test(navigator.userAgent)&&(this._window.opener=self),this.focus(),this._window},t.prototype._authorizeAction=function(t){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){var r,i,s=this;return o(this,(function(o){return"GET"===this.authenticateMethod?i=e.SERVICE_URL+"/woa?"+d.buildQueryParams({a:btoa(this._thirdPartyInfo())}):(r=this._buildFormElement(e.AUTHENTICATE_REQUEST_URL),document.body.appendChild(r)),[2,new Promise((function(o,a){var c=s.present(i);s.dispatch=new l.Dispatch({methods:{authorize:function(t,e,r){h(t)?o({restricted:e&&"1"===e,userToken:t,cid:r}):a(u.NOT_DETERMINED)},close:function(){},decline:function(){a(u.DENIED)},switchUserId:function(){a(u.NOT_DETERMINED)},thirdPartyInfo:function(){return s._thirdPartyInfo(s.developerToken,n(n({},s.deeplinkParameters),t))},unavailable:function(){a(u.UNAVAILABLE)}},origin:e.SERVICE_URL,source:window,destination:c}),r&&r.submit()}))]}))}))},t.prototype._buildFormElement=function(t,e,r){void 0===e&&(e=this.target),void 0===r&&(r=this.developerToken);var n=document.createElement("form");n.setAttribute("method","post"),n.setAttribute("action",t),n.setAttribute("target",e),n.style.display="none";var i=document.createElement("input");i.setAttribute("name","jwtToken"),i.setAttribute("value",r),n.appendChild(i);var o=document.createElement("input");o.setAttribute("name","isWebPlayer"),o.setAttribute("value","true"),n.appendChild(o);var s=document.createElement("input");return s.setAttribute("name","LogoURL"),s.setAttribute("value",""),n.appendChild(s),n},t.prototype._calculateClientDimensions=function(t){return void 0===t&&(t=window),{height:t.innerHeight?t.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,left:t.screenLeft?t.screenLeft:screen.availLeft||screen.left,top:t.screenTop?t.screenTop:screen.availTop||screen.top,width:t.innerWidth?t.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width}},t.prototype._subscribeAction=function(t){return void 0===t&&(t={}),i(this,void 0,void 0,(function(){var r=this;return o(this,(function(n){return Object.assign(t,this.deeplinkParameters),[2,new Promise((function(n,i){var o=e.SUBSCRIBE_URL+"?"+d.buildQueryParams(t);r.present(o),window.addEventListener("message",(function(t){var r=t.data,o=t.origin,s=(t.source,"string"===typeof r?JSON.parse(r):r),a=(s.closeWindow,s.launchClient);o&&!e.WHITELIST_DOMAIN_REGEX.test(o)||(a?0===a.supported?i("Unable to subscribe on this platform."):n(a):i("Subscribe action error."))}))}))]}))}))},t.prototype._thirdPartyInfo=function(t,e){var r;void 0===t&&(t=this.developerToken);var n=this.iconURL,i=window.location.host||document.referrer,o=a([].slice.call(document.querySelectorAll('link[rel="apple-music-app-icon"]')),[].slice.call(document.querySelectorAll('link[rel="apple-touch-icon-precomposed"]')),[].slice.call(document.querySelectorAll('link[rel="apple-touch-icon"]')));if(o&&o[0]&&o[0].href){var s=o.find((function(t){return!!t.sizes&&"120x120"===t.sizes.value}));n=null!==(r=null===s||void 0===s?void 0:s.href)&&void 0!==r?r:o[0].href}return JSON.stringify({thirdPartyIconURL:n,thirdPartyName:i,thirdPartyParameters:e,thirdPartyToken:t})},t}();e.ServiceSetupView=f},46649:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(s)try{if(r=1,n&&(i=2&o[0]?n["return"]:o[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},o=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var s=r(10315);function a(t,e){return void 0===e&&(e="https://api.music.apple.com/v1"),n(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:return r=new Headers({Authorization:"Bearer "+t}),[4,fetch(e+"/storefronts",{headers:r})];case 1:return n=i.sent(),[4,n.json()];case 2:return o=i.sent(),o.errors?[2,Promise.reject(o.errors)]:[2,o.data]}}))}))}(function(t){t["ID"]="us",t["LANGUAGE_TAG"]="en-gb"})(e.Defaults||(e.Defaults={})),e.fetchStorefronts=a;var u=function(){function t(t,e,r){this.id=t,this.attributes=e,this.type="storefronts",this.href=r||"/v1/"+this.type+"/"+t}return t.inferFromLanguages=function(t,e){return void 0===e&&(e=s.getLanguages()),n(this,void 0,void 0,(function(){var r,n,s,u,c,l;return i(this,(function(i){switch(i.label){case 0:return[4,a(t)];case 1:return r=i.sent(),n=r.map((function(t){return t.id})),s=e[0]||"en-US",u=o(s.toLowerCase().split(/-|_/),2),u[0],c=u[1],l=n.includes(c)?c:"us",[2,r.find((function(t){return t.id===l}))]}}))}))},t}();e.Storefront=u},98964:function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},t(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(s)try{if(r=1,n&&(i=2&o[0]?n["return"]:o[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},a=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var u=r(50684),c=r(15265),l=r(26066),d=r(31675),h=r(42631),f=r(10315),p=r(56764),v=r(6980),y=r(87933),m=r(36545),g=r(48753),b=r(42476);e.SKRealmBundle=b.SKRealmBundle,e.SKRequiredPrivacyVersion=b.SKRequiredPrivacyVersion;var _=r(44860);e.AuthorizationStatus=_.AuthorizationStatus,e.validateToken=_.validateToken;var w,E=r(46649);(function(t){t["authorizationStatusDidChange"]="authorizationStatusDidChange",t["authorizationStatusWillChange"]="authorizationStatusWillChange",t["eligibleForSubscribeView"]="eligibleForSubscribeView",t["needsGDPRDidChange"]="needsGDPRDidChange",t["storefrontCountryCodeDidChange"]="storefrontCountryCodeDidChange",t["storefrontIdentifierDidChange"]="storefrontIdentifierDidChange",t["userTokenDidChange"]="userTokenDidChange"})(w=e.StoreKitNotifications||(e.StoreKitNotifications={})),e.PLDFLTCID="pldfltcid";var T=!1;T=!0;var S=function(t){function e(e,r){var n=t.call(this,[w.authorizationStatusDidChange,w.authorizationStatusWillChange,w.eligibleForSubscribeView,w.needsGDPRDidChange,w.storefrontCountryCodeDidChange,w.userTokenDidChange,w.storefrontIdentifierDidChange])||this;n.developerToken=e,n.apiBase="https://api.music.apple.com/v1",n.iTunesBuyBase="https://buy.itunes.apple.com",n.persist="localstorage",n.playBase="https://play.itunes.apple.com/WebObjects/MZPlay.woa/wa",n.prefix="music",n.realm=0,n.storage=window.localStorage,n._authorizationStatus=_.AuthorizationStatus.NOT_DETERMINED,n._dispatchedSubscribeView=!1,n._me=null,n._cids={},n._gdprVersion=-1,n._needsGDPR=void 0,n._dynamicUserToken=y.getCookie("media-user-token"),r&&(r.apiBase&&(n.apiBase=r.apiBase),r.deeplink&&(n.deeplinkParameters=r.deeplink),r.persist&&(n.persist=r.persist),r.prefix&&(n.prefix=r.prefix),void 0!==r.realm&&(n.realm=r.realm),n.bundleId=b.SKRealmBundle[n.realm]),n.cidNamespace=b.SKRealmCidNamespace[n.realm],n._developerToken=new c.DeveloperToken(e),n._serviceSetupView=new _.ServiceSetupView(e,{authenticateMethod:r&&r.authenticateMethod,iconURL:r&&r.iconURL,deeplinkParameters:n.deeplinkParameters}),n.storagePrefix=(n.prefix+"."+n._developerToken.teamId).toLocaleLowerCase();var i=n._getStorageItem("media-user-token");return n.userToken=i||void 0,n.developerToken&&n.userTokenIsValid&&(n._restrictedEnabled=n.restrictedEnabled,n.shouldDisplayPrivacyLink(n.bundleId).catch((function(){}))),n._storefrontCountryCode=n.storefrontCountryCode,m.isNodeEnvironment()||n._processLocationHash(window.location.hash),n}return n(e,t),Object.defineProperty(e.prototype,"authorizationStatus",{get:function(){return this._authorizationStatus},set:function(t){this._authorizationStatus!==t&&(this.dispatchEvent(w.authorizationStatusWillChange,{authorizationStatus:this._authorizationStatus,newAuthorizationStatus:t}),this._authorizationStatus=t,this.dispatchEvent(w.authorizationStatusDidChange,{authorizationStatus:t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cid",{get:function(){if(!this._cids[this.cidNamespace]){var t=this._getStorageItem(this.cidNamespace);this._cids[this.cidNamespace]=t||void 0}return this._cids[this.cidNamespace]},set:function(t){t?this._setStorageItem(this.cidNamespace,t):this._removeStorageItem(this.cidNamespace),this._cids[this.cidNamespace]=t},enumerable:!0,configurable:!0}),e.prototype.eligibleForSubscribeView=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.hasMusicSubscription()];case 1:return t=e.sent(),[2,(!this.hasAuthorized||this.hasAuthorized&&!t)&&!this._dispatchedSubscribeView]}}))}))},Object.defineProperty(e.prototype,"hasAuthorized",{get:function(){return this.authorizationStatus>_.AuthorizationStatus.DENIED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logoutURL",{get:function(){return T?this.iTunesBuyBase+"/account/web/logout":this.playBase+"/webPlayerLogout"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentalControls",{get:function(){return this._parentalControls},set:function(t){this._parentalControls=t,t&&(0===this.realm?this.restrictedEnabled=t.musicParentalControlsEnabled:2===this.realm&&t.videoContentRestrictions&&(this.authorizationStatus=_.AuthorizationStatus.RESTRICTED))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_pldfltcid",{get:function(){return this._cids["pldfltcid"]},set:function(t){this._cids["pldfltcid"]=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"privacyAcknowledgements",{get:function(){return this._privacyAcknowledgements},set:function(t){if(this._privacyAcknowledgements=t,!t)return this._gdprVersion=-1,void(this._needsGDPR=void 0);this.bundleId&&(this._gdprVersion=t[this.bundleId]||0,this._needsGDPR=this._gdprVersion<(b.SKRequiredPrivacyVersion[this.bundleId]||0),this._needsGDPR&&this.dispatchEvent(w.needsGDPRDidChange,{GDPRVersion:this._gdprVersion,needsGDPR:this._needsGDPR}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrictedEnabled",{get:function(){if(this.userToken&&"boolean"!==typeof this._restrictedEnabled){var t=this._getStorageItem("itre");if(t)this._restrictedEnabled="0"!==t;else if(this._storefrontCountryCode){var e=["br","ch","gt","hu","id","in","it","kr","la","lt","my","ru","sg","tr"];this._restrictedEnabled=-1!==e.indexOf(this._storefrontCountryCode)||void 0}}return this._restrictedEnabled},set:function(t){this.userToken&&void 0!==t&&this._setStorageItem("itre",t?"1":"0"),this._restrictedEnabled=t,t&&(this.authorizationStatus=_.AuthorizationStatus.RESTRICTED)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storefrontCountryCode",{get:function(){if(!this._storefrontCountryCode){var t=this._getStorageItem("itua");this._storefrontCountryCode=(null===t||void 0===t?void 0:t.toLowerCase())||E.Defaults.ID}return this._storefrontCountryCode},set:function(t){t&&this.userToken?this._setStorageItem("itua",t):this._removeStorageItem("itua"),this._storefrontCountryCode=t,this.dispatchEvent(w.storefrontCountryCodeDidChange,{storefrontCountryCode:t})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"storefrontIdentifier",{get:function(){return this._storefrontIdentifier},set:function(t){this._storefrontIdentifier=t,this.dispatchEvent(w.storefrontIdentifierDidChange,{storefrontIdentifier:t})},enumerable:!0,configurable:!0}),e.prototype.runTokenValidations=function(t,e){void 0===e&&(e=!0),t&&_.validateToken(t)?(e&&this._setStorageItem("media-user-token",t),this.authorizationStatus=this.restrictedEnabled?_.AuthorizationStatus.RESTRICTED:_.AuthorizationStatus.AUTHORIZED):(this._removeStorageItem("media-user-token"),this.authorizationStatus=_.AuthorizationStatus.NOT_DETERMINED)},e.prototype.wrapDynamicUserTokenForChanges=function(t,e){var r=this;if(void 0===e&&(e=l.resolveToString(t)),"function"!==typeof t)return t;var n=e;return function(){var e=l.resolveToString(t);return n!==e&&(n=e,r.runTokenValidations(e,!1),r.dispatchEvent(w.userTokenDidChange,{userToken:e})),e||""}},Object.defineProperty(e.prototype,"dynamicUserToken",{get:function(){return this._dynamicUserToken},set:function(t){var e=l.resolveToString(t);this._dynamicUserToken=this.wrapDynamicUserTokenForChanges(t,e),this.runTokenValidations(e,"function"!==typeof t),this.dispatchEvent(w.userTokenDidChange,{userToken:e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userToken",{get:function(){return l.resolveToString(this.dynamicUserToken)},set:function(t){this.dynamicUserToken=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userTokenIsValid",{get:function(){return _.validateToken(this.userToken)},enumerable:!0,configurable:!0}),e.prototype.deeplinkURL=function(t){return void 0===t&&(t={}),t=i(i({},this.deeplinkParameters||{}),t),"https://finance-app.itunes.apple.com/deeplink?"+g.buildQueryParams(t)},e.prototype.itunesDeeplinkURL=function(t){return void 0===t&&(t={p:"browse"}),t=i(i({},this.deeplinkParameters||{}),t),"https://itunes.apple.com/deeplink?"+g.buildQueryParams(t)},e.prototype.pldfltcid=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:if(this._cids["pldfltcid"])return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.infoRefresh()];case 2:return t.sent(),[3,4];case 3:return t.sent(),[2,void 0];case 4:return[2,this._cids["pldfltcid"]]}}))}))},e.prototype.renewUserToken=function(){return o(this,void 0,void 0,(function(){var t,e,r;return s(this,(function(n){switch(n.label){case 0:return this.userToken?(t=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),[4,fetch(this.playBase+"/renewMusicToken",{method:"POST",headers:t})]):[2,this.requestUserToken()];case 1:return e=n.sent(),401!==e.status?[3,3]:[4,this.revokeUserToken()];case 2:return n.sent(),[2,Promise.reject(new Error("Renew token"))];case 3:return[4,e.json()];case 4:return r=n.sent(),r["music-token"]&&(this.userToken=r["music-token"]),[2,this.userToken]}}))}))},e.prototype.requestStorefrontCountryCode=function(){return o(this,void 0,void 0,(function(){var t,e,r,n,i;return s(this,(function(o){switch(o.label){case 0:return this.authorizationStatus<=_.AuthorizationStatus.DENIED?[2,Promise.reject("Not authorized: "+this.authorizationStatus)]:(t=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken||""}),[4,fetch(this.apiBase+"/me/storefront",{headers:t})]);case 1:return e=o.sent(),e&&!e.ok?(this._reset(),[2,Promise.reject("Storefront Country Code error.")]):[4,e.json()];case 2:return r=o.sent(),r.errors?[2,Promise.reject(r.errors)]:(n=a(r.data,1),i=n[0],i&&i.id?(this.storefrontCountryCode=i.id,[2,this.storefrontCountryCode]):[2,Promise.reject("Storefront Country Code error.")])}}))}))},e.prototype.requestStorefrontIdentifier=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return this.storefrontIdentifier?[3,2]:[4,E.Storefront.inferFromLanguages(this.developerToken)];case 1:t=e.sent(),this.storefrontIdentifier=t.id,e.label=2;case 2:return[2,this.storefrontIdentifier]}}))}))},e.prototype.requestUserToken=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:if(this._serviceSetupView.isServiceView)return[2,this.userToken||""];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._serviceSetupView.load({action:_.ServiceSetupAction.AUTHORIZE})];case 2:return t=r.sent(),this.cid=t.cid,this.userToken=t.userToken,this.restrictedEnabled=t.restricted,[3,4];case 3:return e=r.sent(),this._reset(),this.authorizationStatus=e,[2,Promise.reject(e)];case 4:return[2,this.userToken]}}))}))},e.prototype.revokeUserToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this._webPlayerLogout()];case 1:return t.sent(),[3,3];case 2:return t.sent(),[3,3];case 3:return this.dispatchEvent(w.authorizationStatusWillChange,{authorizationStatus:this.authorizationStatus,newAuthorizationStatus:_.AuthorizationStatus.NOT_DETERMINED}),this._reset(),this.dispatchEvent(w.authorizationStatusDidChange,{authorizationStatus:this.authorizationStatus}),this.dispatchEvent(w.userTokenDidChange,{userToken:this.userToken}),[2]}}))}))},e.prototype.setCids=function(t){var e=this;this._cids=i(i({},this._cids),t),Object.keys(this._cids).forEach((function(t){e._setStorageItem(t,e._cids[t])}))},e.prototype.shouldDisplayPrivacyLink=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t||(t=this.bundleId),void 0!==this._needsGDPR?[2,this._needsGDPR]:[4,this.me()];case 1:return e.sent(),[2,this._needsGDPR]}}))}))},e.prototype.hasMusicSubscription=function(){var t;return o(this,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return this.hasAuthorized?[4,this.me()]:[2,!1];case 1:return e=r.sent(),[2,!!(null===(t=e.subscription)||void 0===t?void 0:t.active)]}}))}))},e.prototype.presentSubscribeViewForEligibleUsers=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),o(this,void 0,void 0,(function(){var r,n;return s(this,(function(i){switch(i.label){case 0:return[4,this.eligibleForSubscribeView()];case 1:if(r=i.sent(),this._serviceSetupView.isServiceView||!r)return[2];if(!e)return this.dispatchEvent(w.eligibleForSubscribeView,t),this._dispatchedSubscribeView=!0,[2];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this._serviceSetupView.load({action:_.ServiceSetupAction.SUBSCRIBE})];case 3:return n=i.sent(),this._dispatchedSubscribeView=!0,[2,n];case 4:return i.sent(),[2,this.revokeUserToken()];case 5:return[2]}}))}))},e.prototype.infoRefresh=function(){return o(this,void 0,void 0,(function(){var t,e,r;return s(this,(function(n){switch(n.label){case 0:if(this.authorizationStatus<=_.AuthorizationStatus.DENIED)return[2,Promise.reject("Not authorized: "+this.authorizationStatus)];if(2!==this.realm)return[3,5];t=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken||""}),n.label=1;case 1:return n.trys.push([1,4,,5]),[4,fetch(this.iTunesBuyBase+"/account/web/infoRefresh",{credentials:"include",headers:t})];case 2:return e=n.sent(),[4,e.json()];case 3:return r=n.sent(),this.setCids(r),[3,5];case 4:return n.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.me=function(){var t=this;return this.authorizationStatus<=_.AuthorizationStatus.DENIED?Promise.reject("Not authorized: "+this.authorizationStatus):(this._me||(this._me=new Promise((function(e,r){return o(t,void 0,void 0,(function(){var t,n,i,o,a,u,c;return s(this,(function(s){switch(s.label){case 0:return t=new Headers({Authorization:"Bearer "+this.developerToken,"Music-User-Token":this.userToken||""}),[4,fetch(this.apiBase+"/me/account?meta=subscription",{headers:t})];case 1:return n=s.sent(),n&&!n.ok?(2!==this.realm&&this._reset(),[2,r("Account error.")]):[4,n.json()];case 2:if(i=s.sent(),i.errors)return[2,r(i.errors)];if(o=i.data,a=i.meta,!a||!a.subscription)return[2,r("Account error.")];this.storefrontCountryCode=a.subscription.storefront,u={subscription:a.subscription},o&&o.length&&(u.attributes=o[0].attributes),s.label=3;case 3:return s.trys.push([3,13,,14]),[4,fetch(this.iTunesBuyBase+"/account/web/info",{credentials:"include",headers:t})];case 4:return c=s.sent(),[4,c.json()];case 5:if(i=s.sent(),this.parentalControls=i.parentalControlsData,this.privacyAcknowledgements=i.privacyAcknowledgement,!v.isEmpty(this.privacyAcknowledgements||{}))return[3,12];s.label=6;case 6:return s.trys.push([6,8,,9]),[4,this.infoRefresh()];case 7:return s.sent(),[3,9];case 8:return s.sent(),e(u),[3,9];case 9:return[4,fetch(this.iTunesBuyBase+"/account/web/info",{credentials:"include",headers:t})];case 10:return c=s.sent(),[4,c.json()];case 11:i=s.sent(),this.parentalControls=i.parentalControlsData,this.privacyAcknowledgements=i.privacyAcknowledgement,s.label=12;case 12:return u.info=i,[3,14];case 13:return s.sent(),[3,14];case 14:return[2,e(u)]}}))}))})).then((function(e){return t._me=null,e})).catch((function(e){return t._me=null,Promise.reject(e)}))),this._me)},e.prototype.musicSubscriptionOffers=function(t,e){return void 0===e&&(e=f.getLanguages()),o(this,void 0,void 0,(function(){var r,n,i,o,a,c,l,f;return s(this,(function(s){switch(s.label){case 0:return this.hasAuthorized?[4,this.me()]:[3,2];case 1:return n=s.sent(),r=n.info.storeFrontISO3A,[3,5];case 2:return t?[3,4]:[4,E.Storefront.inferFromLanguages(this.developerToken,e)];case 3:i=s.sent(),t=null===i||void 0===i?void 0:i.id,s.label=4;case 4:r=t&&d.ISO_2_TO_3_CODES[t.toUpperCase()]||"USA",s.label=5;case 5:return o=h.getLanguageId(e[0]),a=u.COUNTRY_CODE_TO_STOREFRONT[r],o&&a?(c=new Headers,c.set("X-Apple-Store-Front",a+"-"+o+",8"),[4,fetch(this.iTunesBuyBase+"/commerce/web/subscription/offers/music",{headers:c})]):[2,[]];case 6:return l=s.sent(),l.ok?[4,l.json()]:[2,Promise.reject(l.status)];case 7:return f=s.sent(),[2,f.offers]}}))}))},e.prototype._getStorageItem=function(t){if(t)return"cookie"===this.persist?y.getCookie(t):"localstorage"===this.persist?this.storage.getItem(this.storagePrefix+"."+t):void 0},e.prototype._processLocationHash=function(t){var e=/^\#([a-zA-Z0-9+\/]{200,}={0,2})$/;if(e.test(t)){var r=t.replace(e,"$1");try{var n=JSON.parse(atob(r)),i=n.itre,o=n.musicUserToken,s=n.cid;this.restrictedEnabled=i&&"1"===i,this.userToken=o,this.cid=s}catch(a){}history.replaceState(null,document.title," ")}},e.prototype._removeStorageItem=function(t){return"cookie"===this.persist?y.setCookie(t,"","/",0):"localstorage"===this.persist?this.storage.removeItem(this.storagePrefix+"."+t):void 0},e.prototype._reset=function(t){var e=this;void 0===t&&(t=_.AuthorizationStatus.NOT_DETERMINED);var r=this;r.storagePrefix,r.userToken,r._cids;this._authorizationStatus=t,this._cids={},this._dispatchedSubscribeView=!1,this._restrictedEnabled=void 0,this._storefrontCountryCode=void 0,Object.keys(this._cids).forEach((function(t){e._removeStorageItem(t)})),this._removeStorageItem("itre"),this._removeStorageItem("media-user-token"),this._removeStorageItem("itua"),this._dynamicUserToken=void 0,this._me=null,this.privacyAcknowledgements=void 0},e.prototype._setStorageItem=function(t,e){return"cookie"===this.persist?y.setCookie(t,e,"/",180):"localstorage"===this.persist?this.storage.setItem(this.storagePrefix+"."+t,e):void 0},e.prototype._webPlayerLogout=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:return t=new Headers({Authorization:"Bearer "+this.developerToken,Accept:"application/json","Content-Type":"application/json","X-Apple-Music-User-Token":""+this.userToken}),T&&(t.delete("X-Apple-Music-User-Token"),t.append("Music-User-Token",this.userToken||"")),[4,fetch(this.logoutURL,{method:"POST",headers:t,credentials:T?"include":"same-origin"})];case 1:return e=r.sent(),e&&!e.ok?[2,Promise.reject(e.status)]:[2,e.json()]}}))}))},e}(p.Notifications);e.StoreKit=S},44380:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]="undefined"!==typeof FastBoot?FastBoot.require("buffer").Buffer:"undefined"!==typeof process&&null!==process.versions&&null!==process.versions.node?Buffer:window.Buffer},52654:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(36545);function i(t){return void 0===t&&(t=[]),Array.isArray(t)?t:[t]}e.arrayBufferToString=n.memoize((function(t){for(var e=new Uint16Array(t),r=e.length,n="",i=0;i<r;i++)n+=String.fromCharCode(e[i]);return n})),e.base64ToUint8Array=n.memoize((function(t){var r=n.atob(t);return e.stringToUint8Array(r)})),e.ensureArray=i,e.stringToHashCode=n.memoize((function(t){var e=0;if(0!==t.length)for(var r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return e})),e.stringToUint8Array=n.memoize((function(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n})),e.stringToUint16Array=n.memoize((function(t){for(var e=t.length,r=new ArrayBuffer(2*e),n=new Uint16Array(r),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n})),e.uint8ArrayToBase64=n.memoize((function(t){var e,r,n,i,o,s,a,u=0,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";while(u<t.length)e=t[u++],r=u<t.length?t[u++]:Number.NaN,n=u<t.length?t[u++]:Number.NaN,i=e>>2,o=(3&e)<<4|r>>4,s=(15&r)<<2|n>>6,a=63&n,isNaN(r)?s=a=64:isNaN(n)&&(a=64),l+=c.charAt(i)+c.charAt(o)+c.charAt(s)+c.charAt(a);return l}))},50684:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COUNTRY_CODE_TO_STOREFRONT={AFG:"143610",AGO:"143564",AIA:"143538",ALB:"143575",AND:"143611",ARE:"143481",ARG:"143505",ARM:"143524",ATG:"143540",AUS:"143460",AUT:"143445",AZE:"143568",BEL:"143446",BEN:"143576",BFA:"143578",BGD:"143490",BGR:"143526",BHR:"143559",BHS:"143539",BIH:"143612",BLR:"143565",BLZ:"143555",BMU:"143542",BOL:"143556",BRA:"143503",BRB:"143541",BRN:"143560",BTN:"143577",BWA:"143525",CAF:"143623",CAN:"143455",CHE:"143459",CHL:"143483",CHN:"143465",CIV:"143527",CMR:"143574",COD:"143613",COG:"143582",COL:"143501",CPV:"143580",CRI:"143495",CYM:"143544",CYP:"143557",CZE:"143489",DEU:"143443",DMA:"143545",DNK:"143458",DOM:"143508",DZA:"143563",ECU:"143509",EGY:"143516",ESP:"143454",EST:"143518",ETH:"143569",FIN:"143447",FJI:"143583",FRA:"143442",FSM:"143591",GAB:"143614",GBR:"143444",GEO:"143615",GHA:"143573",GIN:"143616",GMB:"143584",GNB:"143585",GRC:"143448",GRD:"143546",GTM:"143504",GUY:"143553",HKG:"143463",HND:"143510",HRV:"143494",HUN:"143482",IDN:"143476",IND:"143467",IRL:"143449",IRQ:"143617",ISL:"143558",ISR:"143491",ITA:"143450",JAM:"143511",JOR:"143528",JPN:"143462",KAZ:"143517",KEN:"143529",KGZ:"143586",KHM:"143579",KNA:"143548",KOR:"143466",KWT:"143493",LAO:"143587",LBN:"143497",LBR:"143588",LBY:"143567",LCA:"143549",LIE:"143522",LKA:"143486",LTU:"143520",LUX:"143451",LVA:"143519",MAC:"143515",MAR:"143620",MCO:"143618",MDA:"143523",MDG:"143531",MDV:"143488",MEX:"143468",MKD:"143530",MLI:"143532",MLT:"143521",MMR:"143570",MNE:"143619",MNG:"143592",MOZ:"143593",MRT:"143590",MSR:"143547",MUS:"143533",MWI:"143589",MYS:"143473",NAM:"143594",NER:"143534",NGA:"143561",NIC:"143512",NLD:"143452",NOR:"143457",NPL:"143484",NRU:"143606",NZL:"143461",OMN:"143562",PAK:"143477",PAN:"143485",PER:"143507",PHL:"143474",PLW:"143595",PNG:"143597",POL:"143478",PRT:"143453",PRY:"143513",PSE:"143596",QAT:"143498",ROU:"143487",RUS:"143469",RWA:"143621",SAU:"143479",SEN:"143535",SGP:"143464",SLB:"143601",SLE:"143600",SLV:"143506",SRB:"143500",STP:"143598",SUR:"143554",SVK:"143496",SVN:"143499",SWE:"143456",SWZ:"143602",SYC:"143599",TCA:"143552",TCD:"143581",THA:"143475",TJK:"143603",TKM:"143604",TON:"143608",TTO:"143551",TUN:"143536",TUR:"143480",TWN:"143470",TZA:"143572",UGA:"143537",UKR:"143492",URY:"143514",USA:"143441",UZB:"143566",VCT:"143550",VEN:"143502",VGB:"143543",VNM:"143471",VUT:"143609",WSM:"143607",XKX:"143624",YEM:"143571",ZAF:"143472",ZMB:"143622",ZWE:"143605"}},15265:function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(e,"__esModule",{value:!0});var i=r(36545),o=function(){function t(t){if(this.token=t,!t||!/^[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}\.[a-z0-9\-\_]{16,}/i.test(t))throw new Error("Invalid token.");var e=n(t.split("."),2),r=e[0],i=e[1],o=this._decode(i),s=o.exp,a=o.iss;if(this.expiration=1e3*s,this.isExpired)throw new Error("Initialized with an expired token.");this.teamId=a;var u=this._decode(r).kid;this.keyId=u}return Object.defineProperty(t.prototype,"isExpired",{get:function(){return this.expiration<Date.now()},enumerable:!0,configurable:!0}),t.prototype._decode=function(t){return JSON.parse(i.atob(t))},t}();e.DeveloperToken=o},40565:function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(e){o(e)}}function a(t){try{u(n["throw"](t))}catch(e){o(e)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return u([t,e])}}function u(o){if(r)throw new TypeError("Generator is already executing.");while(s)try{if(r=1,n&&(i=2&o[0]?n["return"]:o[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(a){o=[6,a],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=r(52654);(function(t){t[t["ParseError"]=-32700]="ParseError",t[t["InvalidRequest"]=-32600]="InvalidRequest",t[t["MethodNotFound"]=-32601]="MethodNotFound",t[t["InvalidParams"]=-32602]="InvalidParams",t[t["InternalError"]=-32603]="InternalError"})(o=e.RPCErrorCodes||(e.RPCErrorCodes={}));var a="*",u="2.0",c=function(){function t(t){var e=this;void 0===t&&(t={}),this._registry={},this._sequence=0,this.handle=function(t){t.data&&t.data.jsonrpc===u&&(e.origin!==a&&e.origin!==t.origin||(t.data.method&&e.destination?e.handleRequest(t.data).then((function(t){e.send(e.destination,t)})):(t.data.hasOwnProperty("result")||t.data.error)&&e.handleResponse(t.data)))},this.destination=t.destination,this.methods=t.methods||{},this.origin=t.origin||a,t.source&&(this.source=t.source)}return Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(t){if(!t&&this._source)return this._source.removeEventListener("message",this.handle),void(this._source=void 0);t.addEventListener("message",this.handle),this._source=t},enumerable:!0,configurable:!0}),t.prototype.apply=function(t,e){var r=this;if(!this.destination)throw new Error("No destination");var n=this._sequence++,i=new Promise((function(t,e){r._registry[n]={resolve:t,reject:e}}));return this.send(this.destination,{jsonrpc:u,id:n,method:t,params:e}),i},t.prototype.call=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return this.apply(t,e)},t.prototype.handleRequest=function(t){return n(this,void 0,void 0,(function(){var e,r,n,a;return i(this,(function(i){switch(i.label){case 0:if(e={jsonrpc:u,id:t.id},r=this.methods[t.method],!r)return[2,Object.assign(e,{error:{code:o.MethodNotFound,message:"Method not found"}})];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,r.apply(null,s.ensureArray(t.params))];case 2:return n=i.sent(),[2,Object.assign(e,{result:n})];case 3:return a=i.sent(),[2,Object.assign(e,{error:{code:a.code||o.InternalError,message:a.message}})];case 4:return[2]}}))}))},t.prototype.handleResponse=function(t){var e=this._registry[t.id];delete this._registry[t.id],e&&(t.error?e.reject(Object.assign(Error(),t.error)):e.resolve(t.result))},t.prototype.send=function(t,e){t.postMessage(e,t.window===t?this.origin:void 0)},t}();e.Dispatch=c},26066:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createInvocableResolver=function(t){return function(e){return void 0===e||null===e||t(e)?e:e()}},e.resolveToString=e.createInvocableResolver((function(t){return"string"===typeof t}))},31675:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ISO_2_TO_3_CODES={AW:"ABW",AF:"AFG",AO:"AGO",AI:"AIA",AX:"ALA",AL:"ALB",AD:"AND",AE:"ARE",AR:"ARG",AM:"ARM",AS:"ASM",AQ:"ATA",TF:"ATF",AG:"ATG",AU:"AUS",AT:"AUT",AZ:"AZE",BI:"BDI",BE:"BEL",BJ:"BEN",BQ:"BES",BF:"BFA",BD:"BGD",BG:"BGR",BH:"BHR",BS:"BHS",BA:"BIH",BL:"BLM",BY:"BLR",BZ:"BLZ",BM:"BMU",BO:"BOL",BR:"BRA",BB:"BRB",BN:"BRN",BT:"BTN",BV:"BVT",BW:"BWA",CF:"CAF",CA:"CAN",CC:"CCK",CH:"CHE",CL:"CHL",CN:"CHN",CI:"CIV",CM:"CMR",CD:"COD",CG:"COG",CK:"COK",CO:"COL",KM:"COM",CV:"CPV",CR:"CRI",CU:"CUB",CW:"CUW",CX:"CXR",KY:"CYM",CY:"CYP",CZ:"CZE",DE:"DEU",DJ:"DJI",DM:"DMA",DK:"DNK",DO:"DOM",DZ:"DZA",EC:"ECU",EG:"EGY",ER:"ERI",EH:"ESH",ES:"ESP",EE:"EST",ET:"ETH",FI:"FIN",FJ:"FJI",FK:"FLK",FR:"FRA",FO:"FRO",FM:"FSM",GA:"GAB",GB:"GBR",GE:"GEO",GG:"GGY",GH:"GHA",GI:"GIB",GN:"GIN",GP:"GLP",GM:"GMB",GW:"GNB",GQ:"GNQ",GR:"GRC",GD:"GRD",GL:"GRL",GT:"GTM",GF:"GUF",GU:"GUM",GY:"GUY",HK:"HKG",HM:"HMD",HN:"HND",HR:"HRV",HT:"HTI",HU:"HUN",ID:"IDN",IM:"IMN",IN:"IND",IO:"IOT",IE:"IRL",IR:"IRN",IQ:"IRQ",IS:"ISL",IL:"ISR",IT:"ITA",JM:"JAM",JE:"JEY",JO:"JOR",JP:"JPN",KZ:"KAZ",KE:"KEN",KG:"KGZ",KH:"KHM",KI:"KIR",KN:"KNA",KR:"KOR",KW:"KWT",LA:"LAO",LB:"LBN",LR:"LBR",LY:"LBY",LC:"LCA",LI:"LIE",LK:"LKA",LS:"LSO",LT:"LTU",LU:"LUX",LV:"LVA",MO:"MAC",MF:"MAF",MA:"MAR",MC:"MCO",MD:"MDA",MG:"MDG",MV:"MDV",MX:"MEX",MH:"MHL",MK:"MKD",ML:"MLI",MT:"MLT",MM:"MMR",ME:"MNE",MN:"MNG",MP:"MNP",MZ:"MOZ",MR:"MRT",MS:"MSR",MQ:"MTQ",MU:"MUS",MW:"MWI",MY:"MYS",YT:"MYT",NA:"NAM",NC:"NCL",NE:"NER",NF:"NFK",NG:"NGA",NI:"NIC",NU:"NIU",NL:"NLD",NO:"NOR",NP:"NPL",NR:"NRU",NZ:"NZL",OM:"OMN",PK:"PAK",PA:"PAN",PN:"PCN",PE:"PER",PH:"PHL",PW:"PLW",PG:"PNG",PL:"POL",PR:"PRI",KP:"PRK",PT:"PRT",PY:"PRY",PS:"PSE",PF:"PYF",QA:"QAT",RE:"REU",RO:"ROU",RU:"RUS",RW:"RWA",SA:"SAU",SD:"SDN",SN:"SEN",SG:"SGP",GS:"SGS",SH:"SHN",SJ:"SJM",SB:"SLB",SL:"SLE",SV:"SLV",SM:"SMR",SO:"SOM",PM:"SPM",RS:"SRB",SS:"SSD",ST:"STP",SR:"SUR",SK:"SVK",SI:"SVN",SE:"SWE",SZ:"SWZ",SX:"SXM",SC:"SYC",SY:"SYR",TC:"TCA",TD:"TCD",TG:"TGO",TH:"THA",TJ:"TJK",TK:"TKL",TM:"TKM",TL:"TLS",TO:"TON",TT:"TTO",TN:"TUN",TR:"TUR",TV:"TUV",TW:"TWN",TZ:"TZA",UG:"UGA",UA:"UKR",UM:"UMI",UY:"URY",US:"USA",UZ:"UZB",VA:"VAT",VC:"VCT",VE:"VEN",VG:"VGB",VI:"VIR",VN:"VNM",VU:"VUT",WF:"WLF",WS:"WSM",XK:"XKX",YE:"YEM",ZA:"ZAF",ZM:"ZMB",ZW:"ZWE"}},42631:(t,e)=>{"use strict";function r(t){void 0===t&&(t="en-US");var r=e.LANGUAGE_TO_STOREFRONT[t.toLowerCase()];if(r)return r;var n=t.includes("-");if(n){var i=t.split("-")[0],o=e.LANGUAGE_TO_STOREFRONT[i.toLowerCase()];if(o)return o}return e.LANGUAGE_TO_STOREFRONT["en-us"]}Object.defineProperty(e,"__esModule",{value:!0}),e.getLanguageId=r,e.LANGUAGE_TO_STOREFRONT={af:48,sq:1,ar:34,eu:1,bg:49,be:1,ca:42,zh:19,"zh-tw":18,"zh-cn":19,"zh-hk":45,"zh-sg":19,hr:41,cs:22,da:11,nl:10,"nl-be":65,en:1,"en-us":1,"en-eg":26,"en-au":27,"en-gb":2,"en-ca":6,"en-nz":27,"en-ie":26,"en-za":26,"en-jm":26,"en-bz":26,"en-tt":26,"en-001":26,et:30,fo:1,fa:59,fi:12,fr:3,"fr-ca":5,gd:2,de:4,"de-ch":57,el:23,he:36,hi:50,hu:21,is:31,id:37,it:7,ja:9,ko:13,lv:33,lt:32,mk:1,mt:1,no:14,nb:14,nn:14,pl:20,"pt-br":15,pt:24,rm:1,ro:39,ru:16,sr:1,sk:40,sl:52,es:8,"es-mx":28,"es-419":44,sv:17,th:35,ts:1,tn:1,tr:25,uk:29,ur:55,ve:1,vi:43,xh:1,yi:1,zu:56,ms:38,iw:36,lo:46,tl:47,kk:51,ta:53,te:54,bn:58,ga:60,ht:61,la:62,pa:63,sa:64}},10315:(t,e)=>{"use strict";function r(){if("undefined"===typeof navigator)return[];if(navigator.languages)return navigator.languages;var t=navigator.language||navigator.userLanguage;return t?[t]:[]}Object.defineProperty(e,"__esModule",{value:!0}),e.getLanguages=r},56764:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){var r=this;void 0===t&&(t=[]),this._eventRegistry={},t.forEach((function(t){r._eventRegistry[t]=[]})),e&&e.namespace&&(this.dispatchNamespace="com.apple."+e.namespace),this.shouldStorageDispatch&&window.addEventListener("storage",this._handleGlobalStorageEvent)}return Object.defineProperty(t.prototype,"shouldStorageDispatch",{get:function(){return"undefined"!==typeof window&&"undefined"!==typeof sessionStorage&&this.dispatchNamespace},enumerable:!0,configurable:!0}),t.prototype.addEventListener=function(t,e){Array.isArray(this._eventRegistry[t])&&this._eventRegistry[t].push(e)},t.prototype.dispatchEvent=function(t,e){Array.isArray(this._eventRegistry[t])&&this._eventRegistry[t].forEach((function(t){return t(e)}))},t.prototype.dispatchDistributedEvent=function(t,e){if(this.dispatchEvent(t,e),this.shouldStorageDispatch){var r=this.dispatchNamespace+":"+t;sessionStorage.setItem(r,JSON.stringify(e))}},t.prototype.removeEventListener=function(t,e){if(Array.isArray(this._eventRegistry[t])){var r=this._eventRegistry[t].indexOf(e);this._eventRegistry[t].splice(r,1)}},t.prototype._handleGlobalStorageEvent=function(t){var e;if(this.dispatchNamespace&&(null===(e=t.key)||void 0===e?void 0:e.startsWith(this.dispatchNamespace+":"))){var r=t.key.substring(this.dispatchNamespace.length+1);this.dispatchEvent(r,JSON.parse(t.newValue))}},t}();e.Notifications=r},6980:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.prototype.hasOwnProperty;function n(t){if("object"!==typeof t||null===t)throw new TypeError("Source is not an Object");var e=Array.isArray(t)?[]:{};for(var i in t)r.call(t,i)&&("object"===typeof t[i]&&null!==t[i]?e[i]=n(t[i]):e[i]=t[i]);return e}function i(t,e){return e.split(".").reduce((function(t,e){if(void 0!==t)return t[e]}),t)}function o(t){if("object"!==typeof t)throw new TypeError("Source is not an Object");for(var e in t)if(r.call(t,e))return!1;return!0}function s(t,e,r){return e.split(".").reduce((function(e,n,i,o){var s=i===o.length-1,a=e.hasOwnProperty(n),u=e[n]instanceof Object,c=null===e[n];if(!s&&a&&(!u||c))throw new TypeError("Value at "+o.slice(0,i+1).join(".")+" in keypath is not an Object.");return s?(e[n]=r,t):a?e[n]:e[n]={}}),t)}function a(t,e){return Object.keys(t).reduce((function(r,n){var o,a=t[n];return o="function"===typeof a?a():i(e,a),o&&s(r,n,o),r}),{})}function u(t,e){return Object.keys(t).reduce((function(r,n){return r[e(n)]=t[n],r}),{})}e.deepClone=n,e.get=i,e.isEmpty=o,e.set=s,e.transform=a,e.transformKeys=u},87933:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){void 0===t&&(t={}),this._data=t}return t.prototype.clear=function(){this._data={}},t.prototype.getItem=function(t){return this._data[t]},t.prototype.removeItem=function(t){delete this._data[t]},t.prototype.setItem=function(t,e){this._data[t]=e},t}();function n(t,e){void 0===t&&(t=""),void 0===e&&(e=document.cookie);var r=e.match(new RegExp("(?:^|;\\s*)"+t+"=([^;]*)"));if(r)return r[1]}function i(t,e,r,n,i){void 0===r&&(r=""),void 0===n&&(n=14),void 0===i&&(i=window);var o=new Date,s=/\./.test(i.location.hostname)?i.location.hostname:"";/^.+\.apple\.com$/i.test(s)&&(s="apple.com");var a=s.length>0?"domain="+s+"; ":"";o.setTime(o.getTime()+24*n*60*60*1e3),i.document.cookie=t+"="+e+"; expires="+o.toUTCString()+"; "+a+"path="+r}e.GenericStorage=r,e.getCookie=n,e.setCookie=i},36545:function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"===typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),s=[];try{while((void 0===e||e-- >0)&&!(n=o.next()).done)s.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=o["return"])&&r.call(o)}finally{if(i)throw i.error}}return s},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var s=o(r(44380));function a(){var t=u()+u();while(t.length<16)t+=u();return t.slice(0,16)}function u(){return Math.random().toString(16).substring(2)}function c(t){var e=function(t){return"undefined"!==typeof t&&null!==t};return 0===arguments.length&&"undefined"!==typeof process&&(t=process),e(t)&&e(t.versions)&&e(t.versions.node)||"undefined"!==typeof FastBoot}function l(t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n="",i=e.length;while(i--){var o=e[i];n+=o===Object(o)?JSON.stringify(o):o,t._memoized||(t._memoized={})}return n in t._memoized?t._memoized[n]:t._memoized[n]=t.apply(void 0,e)}}function d(t){return t?Object.keys(t).reduce((function(e,r){var n=t[r];return n.constructor===Object?Object.keys(n).reduce((function(t,e){return t+(t?"&":"")+encodeURIComponent(r)+"["+encodeURIComponent(e)+"]="+encodeURIComponent(n[e])}),e):e+(e?"&":"")+encodeURIComponent(r)+"="+encodeURIComponent(t[r])}),""):""}function h(t){var e=t.split("/"),r=e.pop(),i=n(!!r&&r.match(/\d+/g)||["100","100"],2),o=i[0],s=i[1];return{width:parseInt(o,10),height:parseInt(s,10),url:t.replace(o+"x"+s,"{w}x{h}")}}function f(t){try{var e=n(t.split("?",2),2),r=e[0],o=e[1];if("undefined"===typeof o)return r;var s=o.split("&").map((function(t){return t.split("=",2)})),a=i(Array(s.length).keys());a.sort((function(t,e){var r=s[t],n=s[e];return r<n?-1:r>n?1:t-e}));var u=a.map((function(t){return s[t]})),c=u.map((function(t){var e=n(t,2),r=e[0],i=e[1];return"undefined"!==typeof i?r+"="+i:r})).join("&");return r+"?"+c}catch(l){return t}}e.generateUUID=a,e.isLibraryType=l((function(t){return/^[a|i|l|p]{1}\.[a-zA-Z0-9]+$/.test(t)})),e.isNodeEnvironment=c,e.atob=l(c()?function(t){return s.default.from(t,"base64").toString("ascii")}:function(t){return window.atob(t)}),e.btoa=l(c()?function(t){return s.default.from(t).toString("base64")}:function(t){return window.btoa(t)}),e.memoize=l,e.urlEncodeParameters=d,e.getArtworkFromURL=h,e.throttled=function(t,e){var r=0;return function(){var n=Date.now();if(!(n-r<t))return r=n,e.apply(this,Array.from(arguments))}},e.debounce=function(t,e,r){var n;return void 0===e&&(e=250),void 0===r&&(r={isImmediate:!1}),function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var s=this,a=function(){n=void 0,r.isImmediate||t.apply(s,i)},u=r.isImmediate&&void 0===n;void 0!==n&&clearTimeout(n),n=setTimeout(a,e),u&&t.apply(s,i)}},e.stableSortQueryParams=f},10369:t=>{"use strict";t.exports=JSON.parse('["ar-dz","ar-bh","ar-eg","ar-iq","ar-jo","ar-kw","ar-lb","ar-ly","ar-ma","ar-om","ar-qa","ar-sa","ar-sd","ar-sy","ar-tn","ar-ae","ar-ye","bn-bd","he-il","iw-il","ca-es","cs-cz","da-dk","de-ch","de-de","el-gr","en-au","en-ca","en-gb","en-us","es-419","es-es","es-mx","es-xl","et-ee","fi-fi","fr-ca","fr-fr","gu-in","hi-in","hr-hr","hu-hu","id-id","is-is","it-it","iw-il","ja-jp","kn-in","ko-kr","lt-lt","lv-lv","ml-in","mr-in","ms-my","nl-nl","no-no","no-nb","nb-no","or-in","pa-in","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sl-si","sv-se","ta-in","te-in","th-th","tr-tr","uk-ua","ur-pk","vi-vi","vi-vn","zh-cn","zh-hans","zh-hans-cn","zh-hant","zh-hant-hk","zh-hant-tw","zh-hk","zh-tw","ar","bn","ca","cs","da","de","el","en","es","fi","fr","gu","he","hi","hr","hu","id","is","it","ja","kn","ko","lt","lv","ml","mr","ms","nb","nl","no","or","pa","pl","pt","ro","ru","sk","sl","sv","ta","te","th","tr","uk","ur","vi","zh"]')}}]);
